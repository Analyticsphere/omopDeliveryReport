<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMOP Delivery Report - Synthea Synthetic Data</title>
    <style>

/* ============================================================================
   OMOP Delivery Report
   ============================================================================ */

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  color: #1e293b;
  background: linear-gradient(135deg, #f5f7fa 0%, #e8ecf1 100%);
  line-height: 1.6;
  font-size: clamp(14px, 0.8vw + 6px, 16px);
  font-weight: 400;
}

.container {
  max-width: 100%;
  margin: 0;
  padding: 0;
  background: transparent;
  min-height: 100vh;
}

/* ============================================================================
   LAYOUT
   ============================================================================ */

.app-wrapper {
  display: flex;
  min-height: 100vh;
}

/* Fixed Left Sidebar - Responsive width */
.sidebar {
  position: fixed;
  left: 0;
  top: 0;
  /* Fluid width: scales from 180px to 220px */
  width: clamp(180px, 15vw, 220px);
  height: 100vh;
  background: #0f172a;
  color: white;
  overflow-y: auto;
  z-index: 1000;
  border-right: 1px solid #1e293b;
}

.sidebar-header {
  /* Fluid padding: scales from 24px to 40px */
  padding: clamp(24px, 3vw, 40px) clamp(16px, 2vw, 24px) clamp(20px, 2.5vw, 32px);
  border-bottom: 1px solid #1e293b;
}

.sidebar-header h1 {
  /* Fluid: scales from ~18px to ~22px */
  font-size: clamp(1.125rem, 1vw + 0.4rem, 1.375rem);
  font-weight: 700;
  letter-spacing: -0.3px;
  margin-bottom: 8px;
  line-height: 1.2;
}

.sidebar-subtitle {
  font-size: clamp(0.7rem, 0.5vw + 0.3rem, 0.85rem);
  opacity: 0.7;
  font-weight: 400;
}

.sidebar-nav {
  padding: 24px 0;
}

.sidebar-nav-item {
  display: block;
  padding: 14px 24px;
  color: rgba(255, 255, 255, 0.7);
  text-decoration: none;
  font-size: 0.95em;
  font-weight: 500;
  transition: all 0.2s ease;
  border-left: 3px solid transparent;
  cursor: pointer;
}

.sidebar-nav-item:hover {
  background: rgba(255, 255, 255, 0.05);
  color: white;
  border-left-color: #3b82f6;
}

.sidebar-nav-item.active {
  background: rgba(59, 130, 246, 0.15);
  color: white;
  border-left-color: #3b82f6;
  font-weight: 600;
}

/* Main Content Area - Matches sidebar width */
.main-content {
  /* Fluid margin: scales with sidebar width from 180px to 220px */
  margin-left: clamp(180px, 15vw, 220px);
  flex: 1;
  min-height: 100vh;
}

/* Header */
.report-header {
  background: white;
  border-bottom: 1px solid #e5e7eb;
  /* Fluid padding: scales from 20px to 48px */
  padding: clamp(20px, 2.5vw, 32px) clamp(24px, 3vw, 48px);
  margin: 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.report-header-content {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.report-header h1 {
  margin: 0;
  /* Fluid: scales from ~22px to ~32px across laptop-desktop range */
  font-size: clamp(1.4rem, 1.5vw + 0.5rem, 2rem);
  font-weight: 700;
  letter-spacing: -0.5px;
  color: #0f172a;
}

.report-subtitle {
  font-size: clamp(0.85rem, 0.6vw + 0.4rem, 1.1rem);
  color: #64748b;
  font-weight: 400;
  margin-top: 4px;
}

.report-header-badge {
  display: inline-flex;
  align-items: center;
  gap: 12px;
  padding: 12px 24px;
  background: #047857;
  color: white;
  border-radius: 4px;
  font-weight: 700;
  font-size: 1.1em;
}

/* ============================================================================
   SECTIONS
   ============================================================================ */

.section {
  /* Fluid padding: scales from 24px to 56px vertical, 20px to 48px horizontal */
  padding: clamp(24px, 3vw + 12px, 56px) clamp(20px, 2.5vw + 10px, 48px);
  margin: clamp(16px, 2vw, 32px) 0;
  background: white;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

.section:first-child {
  margin-top: 0;
}

.section:nth-child(even) {
  background: #fafbfc;
}

.section-header {
  margin-bottom: 16px;
}

.section-icon {
  display: none;
}

.section-header h2 {
  margin: 0;
  /* Fluid: scales from ~20px to ~28px */
  font-size: clamp(1.25rem, 1.2vw + 0.4rem, 1.75rem);
  font-weight: 700;
  color: #0f172a;
  letter-spacing: -0.3px;
  position: relative;
  padding-bottom: 12px;
}

.section-header h2::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  width: 60px;
  height: 3px;
  background: #3b82f6;
}

/* ============================================================================
   SUBSECTIONS
   ============================================================================ */

.subsection {
  margin-top: 24px;
  padding-top: 16px;
  border-top: 1px solid #e5e7eb;
}

.subsection h4 {
  /* Fluid: scales from ~16px to ~20px */
  font-size: clamp(1rem, 0.8vw + 0.4rem, 1.25rem);
  color: #0f172a;
  margin-bottom: 12px;
  font-weight: 600;
  letter-spacing: -0.2px;
  text-align: left;
}

/* ============================================================================
   METRICS
   ============================================================================ */

.metrics-strip {
  display: flex;
  gap: 32px;
  margin-bottom: 48px;
  flex-wrap: wrap;
  align-items: center;
}

.metric-inline {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.metric-label {
  /* Fluid: scales from ~12px to ~15px (increased from 10-12px) */
  font-size: clamp(0.75rem, 0.5vw + 0.4rem, 0.9375rem);
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
}

/* Compact label for longer metric names */
.metric-label-compact {
  /* Slightly smaller font and tighter spacing for long labels */
  font-size: clamp(0.7rem, 0.45vw + 0.38rem, 0.85rem);
  letter-spacing: 0.7px;
  line-height: 1.3;
}

.metric-value {
  /* Fluid: scales from ~28px to ~44px (increased from 24-36px) */
  font-size: clamp(1.75rem, 1.8vw + 0.6rem, 2.75rem);
  font-weight: 700;
  color: #0f172a;
  line-height: 1;
  font-variant-numeric: tabular-nums;
}

.metric-value.warning {
  color: #dc2626;
}

.metric-value.success {
  color: #047857;
}

/* Overview metrics grid - responsive layout */
.overview-metrics-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: clamp(12px, 1vw, 20px);
  margin-bottom: clamp(24px, 2.5vw, 40px);
}

/* Ensure all cards have consistent height */
.overview-metrics-grid .metric-card {
  display: flex;
  flex-direction: column;
  min-height: clamp(120px, 10vw, 160px);
  text-align: center;
  justify-content: center;
  align-items: center;
}

/* Responsive breakpoints for card stacking - LAPTOP TO DESKTOP ONLY */
@media (max-width: 1024px) {
  .overview-metrics-grid {
    grid-template-columns: 1fr;
  }
}

/* Legacy metric cards for drilldown */
.metrics-grid {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: clamp(12px, 1vw, 20px);
  margin-bottom: clamp(24px, 2.5vw, 40px);
}

/* Responsive metrics grid - LAPTOP TO DESKTOP ONLY */
@media (max-width: 1600px) {
  .metrics-grid {
    grid-template-columns: repeat(4, 1fr);
  }
}

@media (max-width: 1280px) {
  .metrics-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (max-width: 1024px) {
  .metrics-grid {
    grid-template-columns: repeat(2, 1fr);
  }
}

/* Quality cards grid - 3-2 layout for 5 cards */
.quality-cards-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: clamp(12px, 1vw, 20px);
  margin-bottom: clamp(16px, 1.5vw, 24px);
}

/* Make the last 2 cards span properly on row 2 */
.quality-cards-grid > .metric-card:nth-child(4) {
  grid-column: 1 / 2;
}

.quality-cards-grid > .metric-card:nth-child(5) {
  grid-column: 2 / 3;
}

/* Responsive: Stack on smaller screens - LAPTOP TO DESKTOP ONLY */
@media (max-width: 1024px) {
  .quality-cards-grid {
    grid-template-columns: repeat(2, 1fr);
  }

  .quality-cards-grid > .metric-card:nth-child(4),
  .quality-cards-grid > .metric-card:nth-child(5) {
    grid-column: auto;
  }
}

.metric-card {
  background: #f8fafc;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  /* Fluid padding: scales from 16px to 24px */
  padding: clamp(16px, 1.5vw, 24px);
  transition: all 0.2s ease;
}

.metric-card:hover {
  border-color: #cbd5e1;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.metric-card.warning {
  border-left: 3px solid #dc2626;
  background: #fef2f2;
}

.metric-card.success {
  border-left: 3px solid #047857;
  background: #f0fdf4;
}

.metric-card.neutral {
  border-left: 3px solid #9ca3af;
  background: #f9fafb;
}

.metric-sublabel {
  /* Fluid: scales from ~13px to ~16px (increased from 12-14px) */
  font-size: clamp(0.8125rem, 0.55vw + 0.4rem, 1rem);
  color: #64748b;
  font-weight: 400;
  margin-top: 4px;
}

/* ============================================================================
   DQD SCORE
   ============================================================================ */

.dqd-score {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  /* Fluid sizing: scales from 80px to 120px */
  min-width: clamp(80px, 8vw, 120px);
  height: clamp(80px, 8vw, 120px);
  border-radius: 50%;
  /* Fluid font: scales from ~24px to ~36px */
  font-size: clamp(1.5rem, 1.8vw + 0.4rem, 2.25rem);
  font-weight: 700;
  color: white;
  font-variant-numeric: tabular-nums;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.dqd-score.good {
  background: linear-gradient(135deg, #10b981 0%, #047857 100%);
}

.dqd-score.fair {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.dqd-score.poor {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.dqd-score.neutral {
  background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
}

.dqd-inline {
  display: inline-block;
  padding: 6px 16px;
  background: #047857;
  color: white;
  border-radius: 4px;
  font-weight: 700;
  font-size: 0.95em;
  font-variant-numeric: tabular-nums;
}

/* ============================================================================
   PASS SCORE
   ============================================================================ */

.pass-score {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: clamp(80px, 8vw, 120px);
  height: clamp(80px, 8vw, 120px);
  border-radius: 50%;
  font-size: clamp(1.5rem, 1.8vw + 0.4rem, 2.25rem);
  font-weight: 700;
  color: white;
  font-variant-numeric: tabular-nums;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.pass-score.excellent {
  background: linear-gradient(135deg, #059669 0%, #047857 100%);
}

.pass-score.good {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
}

.pass-score.moderate {
  background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
}

.pass-score.poor {
  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}

.pass-score.verypoor {
  background: linear-gradient(135deg, #991b1b 0%, #7f1d1d 100%);
}

.pass-score.neutral {
  background: linear-gradient(135deg, #9ca3af 0%, #6b7280 100%);
}

.pass-ci {
  font-size: 0.875rem;
  color: #6b7280;
  margin-top: 8px;
  font-weight: 400;
}

/* PASS Section Styling */
.pass-intro {
  background: #f9fafb;
  padding: 20px;
  margin-bottom: 30px;
  border-radius: 8px;
}

.pass-intro p {
  margin: 0;
  font-size: 0.95rem;
  line-height: 1.6;
  color: #374151;
}

.pass-overall-container {
  background: white;
  border: 2px solid #e5e7eb;
  border-radius: 12px;
  padding: 30px;
  margin-bottom: 40px;
  text-align: center;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.pass-overall-label {
  font-size: 1.3rem;
  font-weight: 600;
  color: #374151;
  margin-bottom: 15px;
}

.pass-overall-score-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
}

.pass-overall-score {
  font-size: 3rem;
  font-weight: 700;
  font-variant-numeric: tabular-nums;
}

.pass-overall-score.excellent { color: #059669; }
.pass-overall-score.good { color: #10b981; }
.pass-overall-score.moderate { color: #f59e0b; }
.pass-overall-score.poor { color: #ef4444; }
.pass-overall-score.verypoor { color: #991b1b; }
.pass-overall-score.neutral { color: #6b7280; }

.pass-overall-ci {
  font-size: 0.9rem;
  color: #94a3b8;
  font-weight: 500;
}

.pass-components-section {
  margin-top: 40px;
}

.pass-components-section h3 {
  font-size: 1.3rem;
  margin-bottom: 10px;
  color: #1f2937;
}

.pass-components-description {
  font-size: 0.95rem;
  color: #6b7280;
  margin-bottom: 25px;
}

/* PASS Components Table */
.pass-components-table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.pass-components-table thead {
  background: #f8fafc;
  border-bottom: 2px solid #e5e7eb;
}

.pass-components-table th {
  text-align: left;
  padding: 14px 16px;
  font-size: 0.8rem;
  font-weight: 600;
  color: #64748b;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pass-components-table tbody tr {
  border-bottom: 1px solid #e5e7eb;
  transition: background-color 0.2s;
}

.pass-components-table tbody tr:last-child {
  border-bottom: none;
}

.pass-components-table tbody tr:hover {
  background: #f8fafc;
}

/* Temporal sub-metric rows - visually nested */
.pass-components-table tbody tr.pass-sub-metric-row {
  background: #f9fafb;
}

.pass-components-table tbody tr.pass-sub-metric-row:hover {
  background: #f3f4f6;
}

/* Only shift the first two columns (Metric and Score), not Description */
.pass-components-table tbody tr.pass-sub-metric-row td:nth-child(1),
.pass-components-table tbody tr.pass-sub-metric-row td:nth-child(2) {
  padding-left: 36px;
}

.pass-components-table tbody tr.pass-sub-metric-row td:nth-child(3) {
  padding-left: 16px;
}

.pass-components-table td {
  padding: 14px 16px;
  font-size: 0.95rem;
}

/* Metric name column */
.pass-metric-name {
  font-weight: 600;
  color: #1f2937;
  text-transform: capitalize;
}

/* Score cell - color coded */
.pass-score-cell {
  font-weight: 700;
  font-variant-numeric: tabular-nums;
  text-align: center;
  border-radius: 4px;
  padding: 6px 12px !important;
}

.pass-score-cell.excellent {
  color: #059669;
  background: #d1fae5;
}

.pass-score-cell.good {
  color: #10b981;
  background: #d1fae5;
}

.pass-score-cell.moderate {
  color: #d97706;
  background: #fef3c7;
}

.pass-score-cell.poor {
  color: #ef4444;
  background: #fee2e2;
}

.pass-score-cell.verypoor {
  color: #991b1b;
  background: #fee2e2;
}

.pass-score-cell.neutral {
  color: #6b7280;
  background: #f3f4f6;
}

/* Description cell */
.pass-description-cell {
  color: #6b7280;
  line-height: 1.5;
  max-width: 500px;
}

/* ============================================================================
   CONTROLS
   ============================================================================ */

.controls {
  background: transparent;
  border: none;
  padding: 0 0 12px 0;
  margin-bottom: 12px;
  display: flex;
  gap: 20px;
  align-items: flex-end;
}

.control-group {
  display: flex;
  gap: 16px;
  align-items: flex-end;
  flex: 1;
}

.control-label {
  font-weight: 600;
  color: #0f172a;
  margin-bottom: 8px;
  display: block;
  font-size: 0.85em;
}

select {
  min-width: 300px;
  padding: 12px 16px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  font-size: 0.95em;
  background: white;
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 500;
  color: #0f172a;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

select:hover {
  border-color: #3b82f6;
}

select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

/* Export Button */
.export-button {
  padding: 12px 24px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9em;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  font-family: inherit;
  box-shadow: 0 2px 4px rgba(59, 130, 246, 0.2);
}

.export-button:hover {
  background: #2563eb;
  box-shadow: 0 4px 8px rgba(59, 130, 246, 0.3);
  transform: translateY(-1px);
}

.export-button:active {
  transform: translateY(0);
}

/* ============================================================================
   TABLES
   ============================================================================ */

.table-container {
  overflow-x: auto;
  margin: 8px 0;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
}

table {
  width: 100%;
  border-collapse: collapse;
  background: white;
  font-variant-numeric: tabular-nums;
}

table.vocab-table {
  font-size: 0.9em;
}

thead {
  background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
  border-bottom: 2px solid #e5e7eb;
}

th {
  padding: 14px 12px;
  text-align: left;
  font-weight: 600;
  font-size: 0.8em;
  letter-spacing: 0.5px;
  color: #475569;
  text-transform: uppercase;
}

/* Status column should have enough width for badges */
th:nth-child(2) {
  min-width: 120px;
}

th.sortable {
  cursor: pointer;
  user-select: none;
  position: relative;
  transition: background 0.15s ease;
}

th.sortable:hover {
  background: rgba(59, 130, 246, 0.08);
}

th.sortable .sort-indicator {
  display: inline-block;
  margin-left: 6px;
  opacity: 0.3;
  font-size: 0.7em;
}

th.sortable .sort-indicator::after {
  content: "\21C5";
}

th.sortable.sort-asc .sort-indicator {
  opacity: 1;
}

th.sortable.sort-asc .sort-indicator::after {
  content: "\2191";
}

th.sortable.sort-desc .sort-indicator {
  opacity: 1;
}

th.sortable.sort-desc .sort-indicator::after {
  content: "\2193";
}

td {
  padding: 14px 12px;
  border-bottom: 1px solid #f1f5f9;
  font-size: 0.95em;
  color: #1e293b;
}

/* Status column cells should have enough width for badges */
td:nth-child(2) {
  min-width: 140px;
}

tbody tr:hover {
  background: #f8fafc;
}

tr:last-child td {
  border-bottom: none;
}

tr.clickable {
  cursor: pointer;
  transition: background 0.15s ease;
}

tr.clickable:hover {
  background-color: #eff6ff;
}

/* Responsive table adjustments for laptops */
@media (max-width: 1280px) {
  th {
    padding: clamp(10px, 1vw, 12px) clamp(8px, 0.8vw, 12px);
  }

  td {
    padding: clamp(10px, 1vw, 12px) clamp(8px, 0.8vw, 12px);
  }
}

tr.row-warning {
  background-color: #fef3c7;
}

tr.row-warning:hover {
  background-color: #fde68a;
}

/* ============================================================================
   STATUS BADGES
   ============================================================================ */

.status-badge {
  display: inline-block;
  padding: 6px 10px;
  border-radius: 4px;
  font-size: 0.7em;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  white-space: nowrap;
}

.status-delivered {
  background: #d1fae5;
  color: #065f46;
  border: 1px solid #10b981;
}

.status-not-delivered {
  background: #fee2e2;
  color: #991b1b;
  border: 1px solid #ef4444;
}

/* DQD Grid */
.dqd-grid-table {
  text-align: center;
  width: 100%;
  table-layout: fixed;
}

.dqd-grid-table th {
  text-align: center;
  padding: 8px 12px;
  white-space: nowrap;
}

.dqd-grid-table td {
  text-align: center;
  padding: 8px 12px;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.dqd-grid-table td:first-child {
  text-align: left;
  font-weight: 600;
  color: #0f172a;
}

/* First column (Category) should be left-aligned and have fixed width */
.dqd-grid-table th:first-child,
.dqd-grid-table td:first-child {
  text-align: left;
  width: 140px;
  padding: 8px 16px;
}

/* Responsive adjustments for DQD grid */
@media (max-width: 1400px) {
  .dqd-grid-table th {
    padding: 8px 8px;
    font-size: 0.75em;
  }

  .dqd-grid-table td {
    padding: 8px 8px;
    font-size: 0.9em;
  }

  .dqd-grid-table th:first-child,
  .dqd-grid-table td:first-child {
    width: 120px;
    padding: 8px 12px;
  }
}

@media (max-width: 1024px) {
  .dqd-grid-table th {
    padding: 6px 6px;
    font-size: 0.7em;
  }

  .dqd-grid-table td {
    padding: 6px 6px;
    font-size: 0.85em;
  }

  .dqd-grid-table th:first-child,
  .dqd-grid-table td:first-child {
    width: 100px;
    padding: 6px 10px;
  }
}

@media (max-width: 768px) {
  .dqd-grid-table {
    font-size: 0.85em;
  }

  .dqd-grid-table th {
    padding: 4px 4px;
    font-size: 0.65em;
  }

  .dqd-grid-table td {
    padding: 4px 4px;
    font-size: 0.8em;
  }

  .dqd-grid-table th:first-child,
  .dqd-grid-table td:first-child {
    width: 90px;
    padding: 4px 8px;
  }
}

.pass-cell {
  color: #047857;
  font-weight: 700;
}

.fail-cell {
  color: #b91c1c;
  font-weight: 700;
}

.total-row {
  background: #f1f5f9;
  font-weight: 700;
  font-size: 1em;
  border-top: 3px solid #cbd5e1;
  border-bottom: 3px solid #cbd5e1;
}

/* Harmonization column styling */
.harmonization-positive {
  color: #047857;
  font-weight: 600;
}

.harmonization-negative {
  color: #dc2626;
  font-weight: 600;
}

.harmonization-neutral {
  color: #64748b;
  font-weight: 500;
}

/* ============================================================================
   CHARTS
   ============================================================================ */

.chart-container {
  margin: 32px 0;
  padding: 0;
  background: transparent;
  border: none;
  display: flex;
  justify-content: flex-start;
}

.chart-title {
  /* Fluid: scales from ~16px to ~20px */
  font-size: clamp(1rem, 0.8vw + 0.4rem, 1.25rem);
  font-weight: 600;
  color: #0f172a;
  margin-bottom: clamp(16px, 2vw, 24px);
  letter-spacing: -0.2px;
  text-align: left;
}

/* ============================================================================
   INFO BOXES
   ============================================================================ */

.info-box {
  background: #f8fafc;
  border-left: 3px solid #3b82f6;
  padding: 20px 24px;
  border-radius: 6px;
  margin: 24px 0;
  border: 1px solid #e5e7eb;
}

.info-box p {
  margin: 8px 0;
  color: #475569;
  line-height: 1.6;
}

/* ============================================================================
   BACK BUTTON
   ============================================================================ */

.back-button {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  background: #6b7280;
  color: white;
  border: none;
  border-radius: 6px;
  font-size: 0.9em;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(107, 114, 128, 0.2);
  margin-bottom: 32px;
}

.back-button:hover {
  background: #4b5563;
  box-shadow: 0 4px 8px rgba(107, 114, 128, 0.3);
  transform: translateY(-1px);
}

.back-button:active {
  transform: translateY(0);
}

/* ============================================================================
   DRILL-DOWN & ANIMATIONS
   ============================================================================ */

.drill-down {
  animation: fadeIn 0.2s ease;
}

.drill-down .section-header h2 {
  padding-bottom: 0;
}

.drill-down .section-header h2::after {
  display: none;
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.table-group-content {
  animation: fadeIn 0.2s ease;
}

/* ============================================================================
   ICONS & BADGES
   ============================================================================ */

.warning-icon {
  color: #dc2626;
  font-size: 1.2em;
  margin-right: 6px;
  vertical-align: middle;
}

.success-icon {
  color: #047857;
  font-size: 1.2em;
  margin-right: 6px;
  vertical-align: middle;
}

/* ============================================================================
   UTILITY CLASSES
   ============================================================================ */

.text-center {
  text-align: center;
}

.mt-20 {
  margin-top: 8px;
}

.text-muted {
  color: #64748b;
  font-style: normal;
}

.hidden {
  display: none !important;
}

/* ============================================================================
   SCROLLBAR STYLING
   ============================================================================ */

::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: #f1f5f9;
}

::-webkit-scrollbar-thumb {
  background: #cbd5e1;
  border-radius: 5px;
}

::-webkit-scrollbar-thumb:hover {
  background: #94a3b8;
}
  
/* ============================================================================
   DATA UNAVAILABLE MESSAGE
   ============================================================================ */

.info-box.data-unavailable {
  background: #fef3c7;
  border-left: 4px solid #f59e0b;
  padding: 24px 28px;
  border-radius: 8px;
  margin: 24px 0;
}

.info-box.data-unavailable h4 {
  margin: 0 0 12px 0;
  color: #92400e;
  font-size: 1.1em;
  font-weight: 600;
}

.info-box.data-unavailable p {
  margin: 8px 0;
  color: #92400e;
  line-height: 1.6;
  font-size: 0.95em;
}

.info-box.data-unavailable p:last-child {
  margin-bottom: 0;
}

/* ============================================================================
   TOGGLE BUTTONS (DATA TIMELINE)
   ============================================================================ */

.toggle-buttons {
  display: flex;
  gap: 12px;
  background: #f1f5f9;
  padding: 6px;
  border-radius: 10px;
  width: fit-content;
}

.toggle-button {
  padding: 10px 24px;
  border: none;
  background: transparent;
  color: #64748b;
  font-size: 0.95em;
  font-weight: 500;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-family: inherit;
}

.toggle-button:hover {
  background: rgba(255, 255, 255, 0.6);
  color: #0f172a;
}

.toggle-button.active {
  background: white;
  color: #0f172a;
  font-weight: 600;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

/* Apply Button Hover */
#btn-apply-custom-years:hover {
  background: #2563eb !important;
}

#btn-apply-custom-years:active {
  background: #1d4ed8 !important;
}

/* Interactive Legend */
.legend-item {
  cursor: pointer;
  user-select: none;
  transition: all 0.2s ease;
}

.legend-item:hover {
  opacity: 0.8;
}

/* Inactive/deactivated legend items stay visible but grayed out */
.legend-item.inactive {
  opacity: 0.4;
}

.legend-item.inactive .legend-label {
  color: #94a3b8 !important;
}

.legend-item.inactive .legend-line {
  background-color: #cbd5e1 !important;
}

/* ============================================================================
   LAPTOP-FOCUSED RESPONSIVE MEDIA QUERIES
   These breakpoints optimize for laptop (1024px) to large desktop (2560px+)
   ============================================================================ */

/* Small Laptops (1024px - 1280px) */
@media (max-width: 1280px) {
  .controls {
    flex-wrap: wrap;
    gap: 16px;
  }

  select {
    min-width: 250px;
  }

  .report-header-content {
    flex-wrap: wrap;
    gap: 16px;
  }
}

/* Very Small Laptops (< 1024px) */
@media (max-width: 1024px) {
  .sidebar {
    width: 180px;
  }

  .main-content {
    margin-left: 180px;
  }

  .control-group {
    flex-direction: column;
    align-items: stretch;
  }

  select {
    min-width: 200px;
    width: 100%;
  }

  .export-button {
    width: 100%;
  }
}

/* ============================================================================
   UTILITY CLASSES FOR REMOVING INLINE STYLES
   ============================================================================ */

/* Report Header */
.report-subtitle {
  font-size: 1.2em;
  font-weight: 500;
  color: #64748b;
  margin-top: 8px;
}

/* Delivery Overview Section */
.overview-section-title {
  margin-top: 32px;
}

.overview-section-subtitle {
  margin-bottom: 4px;
}

.overview-disclaimer {
  font-size: 0.9em;
  color: #94a3b8;
  margin-bottom: 8px;
  text-align: left;
}

.overview-metrics-spacer {
  margin-top: 16px;
}

/* Delivery Report Section */
.export-button-spaced {
  margin-left: 20px;
}

/* Table Group Content */
.dqd-score-text {
  margin: 0 0 4px 0;
}

.table-group-container {
  margin-top: 12px;
  margin-bottom: 8px;
}

.table-group-title {
  margin: 0 0 8px 0;
  font-size: 1.3em;
  color: #0f172a;
}

.table-group-subtitle {
  margin-top: 12px;
  margin-bottom: 8px;
  font-size: 1.1em;
  color: #0f172a;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.type-concepts-header {
  margin-bottom: 4px;
}

.type-concepts-disclaimer {
  font-size: 0.9em;
  color: #94a3b8;
  margin-bottom: 8px;
  text-align: left;
}

.type-concepts-container {
  margin-top: 8px;
}

/* Time Series Section */
.time-series-controls {
  margin-bottom: 24px;
}

.custom-year-range-panel {
  display: none;
  margin-top: 16px;
  padding: 16px;
  background: #f8fafc;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.custom-year-inputs {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
}

.year-input-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.year-input-label {
  font-weight: 500;
  color: #475569;
  font-size: 0.9em;
}

.year-input-field {
  width: 80px;
  padding: 6px 10px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  font-size: 0.9em;
}

.apply-year-range-button {
  padding: 6px 16px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  font-size: 0.9em;
  transition: background 0.2s;
}

.apply-year-range-button:hover {
  background: #2563eb;
}

.time-series-chart-wrapper {
  width: 100%;
  height: 500px;
  position: relative;
}

.time-series-legend-container {
  margin-top: 24px;
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
}

/* Vocabulary Harmonization Section */
.vocab-columns {
  display: flex;
  gap: 32px;
  margin-bottom: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.vocab-column {
  flex: 0 1 400px;
}

.vocab-column-title {
  font-size: 1.1em;
}

.vocab-flow-section {
  margin-top: 40px;
}

.vocab-flow-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  margin-top: 24px;
}

.vocab-flow-header {
  margin-bottom: 16px;
}

.vocab-flow-table-wrapper {
  border: 2px solid #e2e8f0;
  border-radius: 8px;
}

.vocab-flow-table-header {
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
}

/* Table Drilldown Section */
.table-drilldown-hidden {
  display: none;
}

.drilldown-table-title {
  margin: 0 0 4px 0;
  color: #0f172a;
}

.drilldown-table-subtitle {
  font-size: 0.9em;
  color: #64748b;
  font-weight: 400;
}

/* Technical Summary Section */
.tech-summary-metrics {
  display: flex;
  gap: 20px;
  margin-bottom: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.tech-summary-metric-card {
  flex: 0 1 240px;
}

.tech-summary-metric-value {
  font-size: 1.5em;
}

.tech-summary-footer {
  text-align: center;
  margin-top: 30px;
  color: #94a3b8;
  font-size: 0.9em;
}

/* Time Series Controls */
.time-series-controls-wrapper {
  margin-bottom: 24px;
}

#custom-year-controls {
  margin-top: 16px;
  padding: 16px;
  background: #f8fafc;
  border-radius: 8px;
  border: 1px solid #e2e8f0;
}

.custom-year-range-inputs {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
}

.year-input-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.year-input-label {
  font-weight: 500;
  color: #475569;
  font-size: 0.9em;
}

.year-number-input {
  width: 80px;
  padding: 6px 10px;
  border: 1px solid #cbd5e1;
  border-radius: 6px;
  font-size: 0.9em;
}

.year-apply-button {
  padding: 6px 16px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 6px;
  font-weight: 500;
  cursor: pointer;
  font-size: 0.9em;
  transition: background 0.2s;
}

.year-apply-button:hover {
  background: #2563eb;
}

#time-series-chart-container {
  width: 100%;
  height: 500px;
  position: relative;
}

#time-series-legend {
  margin-top: 24px;
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
}

/* Vocabulary Harmonization */
.vocab-versions-container {
  display: flex;
  gap: 32px;
  margin-bottom: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.vocab-metric-card {
  flex: 0 1 400px;
}

.vocab-metric-value-lg {
  font-size: 1.1em;
}

.vocab-subsection-spacing {
  margin-top: 40px;
}

.vocab-tables-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 40px;
  margin-top: 24px;
}

.vocab-table-heading {
  margin-bottom: 16px;
}

.vocab-table-bordered {
  border: 2px solid #e2e8f0;
  border-radius: 8px;
}

.vocab-table-header-gradient {
  background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
}

/* Table Drilldown */
#drilldown-table-name {
  margin: 0 0 4px 0;
  color: #0f172a;
}

.drilldown-subtitle {
  font-size: 0.9em;
  color: #64748b;
  font-weight: 400;
}

/* Technical Summary */
.tech-summary-metrics {
  display: flex;
  gap: 20px;
  margin-bottom: 30px;
  justify-content: center;
  flex-wrap: wrap;
}

.tech-summary-metric-card {
  flex: 0 1 240px;
}

.tech-summary-metric-value-lg {
  font-size: 1.5em;
}

/* Drilldown Content (JavaScript-generated) */
.percentage-display {
  font-size: 0.6em;
  color: #666;
}

.drilldown-alert-box {
  margin-bottom: 20px;
  background-color: #fef3c7;
  border-left: 4px solid #f59e0b;
}

.drilldown-alert-title {
  margin: 0 0 10px 0;
  color: #92400e;
  font-size: 1.1em;
}

.drilldown-alert-text {
  margin: 5px 0;
  color: #92400e;
  font-size: 0.9em;
}

.drilldown-dqd-score {
  min-width: 100px;
  height: 100px;
  font-size: 2em;
}

.drilldown-pass-score {
  min-width: 100px;
  height: 100px;
  font-size: 2em;
}

.drilldown-section-spacing {
  margin-top: 20px;
}

.drilldown-time-series-controls {
  margin-bottom: 16px;
}

.drilldown-time-series-custom-controls {
  margin-bottom: 16px;
  gap: 12px;
  align-items: center;
}

.drilldown-time-series-label {
  font-weight: 500;
  color: #475569;
}

.drilldown-time-series-input {
  width: 100px;
  padding: 8px;
  border: 1px solid #cbd5e1;
  border-radius: 4px;
}

.drilldown-time-series-button {
  padding: 8px 16px;
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: 500;
}

.drilldown-time-series-button:hover {
  background: #2563eb;
}

.drilldown-time-series-chart {
  margin-top: 16px;
  min-height: 400px;
}

/* ============================================================================
   PASS SCORE VISUALIZATION TOOLTIPS
   ============================================================================ */

/* Container for PASS score visualizations with tooltip */
.pass-viz-tooltip {
  position: relative;
  display: inline-block;
  cursor: pointer;
}

/* Tooltip box - hidden by default */
.pass-viz-tooltip .pass-tooltip-text {
  visibility: hidden;
  opacity: 0;
  background-color: #1e293b;
  color: #ffffff;
  text-align: left;
  padding: 8px 12px;
  border-radius: 6px;
  font-size: 13px;
  line-height: 1.5;
  white-space: pre-line;

  /* Position below the element */
  position: absolute;
  top: 125%;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;

  /* Minimum width */
  min-width: 140px;

  /* Smooth transition with no delay */
  transition: opacity 0.15s ease-in-out, visibility 0.15s ease-in-out;

  /* Box shadow for depth */
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);

  /* Prevent tooltip from being clipped */
  pointer-events: none;
}

/* Arrow pointing up */
.pass-viz-tooltip .pass-tooltip-text::after {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #1e293b transparent;
}

/* Show tooltip on hover - instant appearance */
.pass-viz-tooltip:hover .pass-tooltip-text {
  visibility: visible;
  opacity: 1;
}
    </style>
</head>
<body>
    <div class="sidebar">
    <div class="sidebar-header">
        <h1>OMOP REPORT</h1>
        <div class="sidebar-subtitle">Synthea Synthetic Data</div>
    </div>
    <nav class="sidebar-nav">
        <a href="#overview" class="sidebar-nav-item" data-action="scroll-to-section" data-section="overview">Overview</a>
        <a href="#dqd-grid" class="sidebar-nav-item" data-action="scroll-to-section" data-section="dqd-grid">DQD Results</a>
        <a href="#pass-breakdown" class="sidebar-nav-item" data-action="scroll-to-section" data-section="pass-breakdown">PASS Assessment</a>
        <a href="#time-series" class="sidebar-nav-item" data-action="scroll-to-section" data-section="time-series">Data Timeline</a>
        <a href="#delivery-report" class="sidebar-nav-item" data-action="scroll-to-section" data-section="delivery-report">Tables</a>
        <a href="#vocab-harmonization" class="sidebar-nav-item" data-action="scroll-to-section" data-section="vocab-harmonization">Vocabularies</a>
        <a href="#technical-summary" class="sidebar-nav-item" data-action="scroll-to-section" data-section="technical-summary">Technical</a>
    </nav>
</div>
    <div class="main-content">
        <div class="report-header">
    <div class="report-header-content">
        <div>
            <h1>Synthea Synthetic Data</h1>
            <div class="report-subtitle">Delivery Date: 2025-01-01</div>
        </div>
    </div>
</div>
        <div class="section" id="overview">
    <div class="section-header">
        <span class="section-icon"></span>
        <h2>Delivery Overview</h2>
    </div>

    <div class="overview-metrics-grid">
        <div class="metric-card">
            <div class="metric-label">Tables Delivered</div>
            <div class="metric-value">4</div>
            <div class="metric-sublabel">OMOP CDM tables</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">Participants</div>
            <div class="metric-value">109</div>
            <div class="metric-sublabel">Total identifiable persons in dataset</div>
        </div>

        <div class="metric-card">
            <div class="metric-label">Data Quality Dashboard Score</div>
            <div class="text-center mt-20">
                <div class="dqd-score good">99%</div>
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-label metric-label-compact">Profile of Analytic Suitability Score</div>
            <div class="text-center mt-20">
                <div class="pass-score moderate">0.72</div>
            </div>
        </div>

        <div class="metric-card warning">
            <div class="metric-label">Missing Identifiers</div>
            <div class="metric-value"><span class="warning-icon">⚠️</span> 1</div>
            <div class="metric-sublabel">Person with missing identifiers</div>
        </div>

        <div class="metric-card warning">
            <div class="metric-label">Rows Removed</div>
            <div class="metric-value"><span class="warning-icon">⚠️</span> 2</div>
            <div class="metric-sublabel">Due to missing person identifiers</div>
        </div>
    </div>

    <div class="overview-section-title">
        <div class="chart-title overview-section-subtitle">Type Concept Breakdown</div>
        <div class="overview-disclaimer">Dataset-wide</div>
        <div class="chart-container overview-metrics-spacer">
            <div id="dataset-type-concepts" class="type-concept-chart">
                <!-- Dynamically populated by JavaScript -->
            </div>
        </div>
    </div>
</div>
        <div class="section" id="dqd-grid">
    <div class="section-header">
        <span class="section-icon"></span>
        <h2>Data Quality Dashboard Results</h2>
    </div>

    <div class="table-container">
        <table class="dqd-grid-table">
            <thead>
                <tr>
                    <th rowspan="2">Category</th>
                    <th colspan="4">Verification</th>
                    <th colspan="4">Validation</th>
                    <th colspan="4">Total</th>
                </tr>
                <tr>
                    <th>Pass</th><th>Fail</th><th>Total</th><th>% Pass</th>
                    <th>Pass</th><th>Fail</th><th>Total</th><th>% Pass</th>
                    <th>Pass</th><th>Fail</th><th>Total</th><th>% Pass</th>
                </tr>
            </thead>
            <tbody>
                <tr>
    <td><strong>Plausibility</strong></td>
    <td class="pass-cell">513</td>
    <td class="fail-cell">3</td>
    <td>516</td>
    <td><strong>99%</strong></td>
    <td class="pass-cell">291</td>
    <td class="fail-cell">0</td>
    <td>291</td>
    <td><strong>100%</strong></td>
    <td class="pass-cell">804</td>
    <td class="fail-cell">3</td>
    <td>807</td>
    <td><strong>100%</strong></td>
</tr>
<tr>
    <td><strong>Conformance</strong></td>
    <td class="pass-cell">260</td>
    <td class="fail-cell">18</td>
    <td>278</td>
    <td><strong>94%</strong></td>
    <td class="pass-cell">180</td>
    <td class="fail-cell">0</td>
    <td>180</td>
    <td><strong>100%</strong></td>
    <td class="pass-cell">440</td>
    <td class="fail-cell">18</td>
    <td>458</td>
    <td><strong>96%</strong></td>
</tr>
<tr>
    <td><strong>Completeness</strong></td>
    <td class="pass-cell">432</td>
    <td class="fail-cell">0</td>
    <td>432</td>
    <td><strong>100%</strong></td>
    <td class="pass-cell">16</td>
    <td class="fail-cell">1</td>
    <td>17</td>
    <td><strong>94%</strong></td>
    <td class="pass-cell">448</td>
    <td class="fail-cell">1</td>
    <td>449</td>
    <td><strong>100%</strong></td>
</tr>
<tr class="total-row">
    <td><strong>Total</strong></td>
    <td class="pass-cell">2015</td>
    <td class="fail-cell">30</td>
    <td>2045</td>
    <td><strong>99%</strong></td>
    <td class="pass-cell">487</td>
    <td class="fail-cell">1</td>
    <td>488</td>
    <td><strong>100%</strong></td>
    <td class="pass-cell">2502</td>
    <td class="fail-cell">31</td>
    <td>2533</td>
    <td><strong>99%</strong></td>
</tr>
            </tbody>
        </table>
    </div>
</div>
        <div class="section" id="pass-breakdown">
    <div class="section-header">
        <span class="section-icon"></span>
        <h2>PASS Assessment</h2>
    </div>

    <div class="pass-intro">
        <p><strong>Profile of Analytic Suitability Score (PASS)</strong> attempts to characterize an OMOP dataset's potential to answer a broad range of research questions.</p>
    </div>

    <div class="pass-overall-container">
        <div class="pass-overall-label">Composite PASS</div>
        <div class="pass-overall-score-wrapper">
            <span class="pass-overall-score moderate">0.72</span>
        </div>
        <div id="pass-overall-visualization" style="margin-top: 16px; display: flex; justify-content: center;">
            <!-- CI visualization populated by JavaScript -->
        </div>
        <div style="margin-top: 12px; text-align: center;">
            <span class="pass-overall-ci">95% CI: 0.68-0.76</span>
        </div>
    </div>

    <div class="pass-components-section">
        <h3>Composite Score Breakdown</h3>

        <table class="pass-components-table">
            <thead>
                <tr>
                    <th>Metric</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody id="pass-components-container">
                <!-- Dynamically populated by JavaScript -->
            </tbody>
        </table>
    </div>
</div>
        <div class="section" id="time-series">
    <div class="section-header">
        <span class="section-icon"></span>
        <h2>Data Timeline</h2>
    </div>

    <div class="time-series-controls-wrapper">
        <div class="toggle-buttons">
            <button id="btn-recent-view" class="toggle-button active" data-action="switch-time-series-view" data-view="recent">
                Last 15 Years (2010–2024)
            </button>
            <button id="btn-custom-view" class="toggle-button" data-action="switch-time-series-view" data-view="custom">
                Custom
            </button>
        </div>

        <div id="custom-year-controls" style="display: none;">
            <div class="custom-year-range-inputs">
                <div class="year-input-group">
                    <label for="custom-start-year" class="year-input-label">From:</label>
                    <input type="number" id="custom-start-year" value="1970" min="1900" max="2100" class="year-number-input">
                </div>
                <div class="year-input-group">
                    <label for="custom-end-year" class="year-input-label">To:</label>
                    <input type="number" id="custom-end-year" value="2025" min="1900" max="2100" class="year-number-input">
                </div>
                <button id="btn-apply-custom-years" data-action="apply-year-range" class="year-apply-button">
                    Apply
                </button>
            </div>
        </div>
    </div>

    <div id="time-series-chart-container">
        <!-- Chart will be rendered by JavaScript -->
    </div>

    <div id="time-series-legend">
        <!-- Legend will be populated by JavaScript -->
    </div>

    <script type="application/json" id="time-series-data">
    [{"table_name":"condition_occurrence","year":1987,"count":2},{"table_name":"condition_occurrence","year":2000,"count":4},{"table_name":"condition_occurrence","year":2004,"count":17},{"table_name":"condition_occurrence","year":2006,"count":2},{"table_name":"condition_occurrence","year":2007,"count":6},{"table_name":"condition_occurrence","year":2008,"count":2},{"table_name":"condition_occurrence","year":2009,"count":7},{"table_name":"condition_occurrence","year":2011,"count":4},{"table_name":"condition_occurrence","year":2012,"count":2},{"table_name":"condition_occurrence","year":2015,"count":13},{"table_name":"condition_occurrence","year":2017,"count":15},{"table_name":"condition_occurrence","year":2018,"count":14},{"table_name":"condition_occurrence","year":2019,"count":13},{"table_name":"condition_occurrence","year":2020,"count":4},{"table_name":"condition_occurrence","year":2021,"count":43},{"table_name":"condition_occurrence","year":2022,"count":2},{"table_name":"condition_occurrence","year":2023,"count":13},{"table_name":"drug_exposure","year":1970,"count":4},{"table_name":"drug_exposure","year":1973,"count":2},{"table_name":"drug_exposure","year":1975,"count":2},{"table_name":"drug_exposure","year":1976,"count":2},{"table_name":"drug_exposure","year":1977,"count":4},{"table_name":"drug_exposure","year":1986,"count":2},{"table_name":"drug_exposure","year":1987,"count":8},{"table_name":"drug_exposure","year":1989,"count":14},{"table_name":"drug_exposure","year":1990,"count":42},{"table_name":"drug_exposure","year":1991,"count":54},{"table_name":"drug_exposure","year":1992,"count":200},{"table_name":"drug_exposure","year":1993,"count":218},{"table_name":"drug_exposure","year":1994,"count":206},{"table_name":"drug_exposure","year":1995,"count":206},{"table_name":"drug_exposure","year":1996,"count":198},{"table_name":"drug_exposure","year":1997,"count":264},{"table_name":"drug_exposure","year":1998,"count":294},{"table_name":"drug_exposure","year":1999,"count":214},{"table_name":"drug_exposure","year":2000,"count":108},{"table_name":"drug_exposure","year":2001,"count":156},{"table_name":"drug_exposure","year":2002,"count":328},{"table_name":"drug_exposure","year":2003,"count":296},{"table_name":"drug_exposure","year":2004,"count":62},{"table_name":"drug_exposure","year":2005,"count":16},{"table_name":"drug_exposure","year":2006,"count":38},{"table_name":"drug_exposure","year":2007,"count":48},{"table_name":"drug_exposure","year":2008,"count":32},{"table_name":"drug_exposure","year":2009,"count":62},{"table_name":"drug_exposure","year":2010,"count":48},{"table_name":"drug_exposure","year":2011,"count":38},{"table_name":"drug_exposure","year":2012,"count":48},{"table_name":"drug_exposure","year":2013,"count":360},{"table_name":"drug_exposure","year":2014,"count":820},{"table_name":"drug_exposure","year":2015,"count":1070},{"table_name":"drug_exposure","year":2016,"count":730},{"table_name":"drug_exposure","year":2017,"count":678},{"table_name":"drug_exposure","year":2018,"count":556},{"table_name":"drug_exposure","year":2019,"count":688},{"table_name":"drug_exposure","year":2020,"count":978},{"table_name":"drug_exposure","year":2021,"count":1286},{"table_name":"drug_exposure","year":2022,"count":870},{"table_name":"drug_exposure","year":2023,"count":1050},{"table_name":"drug_exposure","year":2024,"count":422},{"table_name":"measurement","year":1970,"count":9},{"table_name":"measurement","year":1989,"count":49},{"table_name":"measurement","year":1990,"count":473},{"table_name":"measurement","year":1991,"count":589},{"table_name":"measurement","year":1992,"count":1867},{"table_name":"measurement","year":1993,"count":1778},{"table_name":"measurement","year":1994,"count":1120},{"table_name":"measurement","year":1995,"count":837},{"table_name":"measurement","year":1996,"count":836},{"table_name":"measurement","year":1997,"count":1119},{"table_name":"measurement","year":1998,"count":1228},{"table_name":"measurement","year":1999,"count":1136},{"table_name":"measurement","year":2000,"count":490},{"table_name":"measurement","year":2001,"count":646},{"table_name":"measurement","year":2002,"count":1424},{"table_name":"measurement","year":2003,"count":1046},{"table_name":"measurement","year":2004,"count":175},{"table_name":"measurement","year":2005,"count":51},{"table_name":"measurement","year":2006,"count":59},{"table_name":"measurement","year":2007,"count":122},{"table_name":"measurement","year":2008,"count":129},{"table_name":"measurement","year":2009,"count":189},{"table_name":"measurement","year":2010,"count":136},{"table_name":"measurement","year":2011,"count":141},{"table_name":"measurement","year":2012,"count":227},{"table_name":"measurement","year":2013,"count":876},{"table_name":"measurement","year":2014,"count":2051},{"table_name":"measurement","year":2015,"count":3694},{"table_name":"measurement","year":2016,"count":3026},{"table_name":"measurement","year":2017,"count":3596},{"table_name":"measurement","year":2018,"count":3516},{"table_name":"measurement","year":2019,"count":4144},{"table_name":"measurement","year":2020,"count":6541},{"table_name":"measurement","year":2021,"count":6820},{"table_name":"measurement","year":2022,"count":4417},{"table_name":"measurement","year":2023,"count":5255},{"table_name":"measurement","year":2024,"count":2078},{"table_name":"observation","year":1989,"count":1},{"table_name":"observation","year":1992,"count":1},{"table_name":"observation","year":1993,"count":2},{"table_name":"observation","year":1994,"count":1},{"table_name":"observation","year":1995,"count":1},{"table_name":"observation","year":1996,"count":1},{"table_name":"observation","year":1997,"count":1},{"table_name":"observation","year":1998,"count":1},{"table_name":"observation","year":1999,"count":7},{"table_name":"observation","year":2000,"count":3},{"table_name":"observation","year":2001,"count":3},{"table_name":"observation","year":2002,"count":3},{"table_name":"observation","year":2003,"count":6},{"table_name":"observation","year":2004,"count":3},{"table_name":"observation","year":2005,"count":1},{"table_name":"observation","year":2006,"count":3},{"table_name":"observation","year":2007,"count":1},{"table_name":"observation","year":2008,"count":1},{"table_name":"observation","year":2009,"count":2},{"table_name":"observation","year":2010,"count":4},{"table_name":"observation","year":2011,"count":2},{"table_name":"observation","year":2012,"count":3},{"table_name":"observation","year":2013,"count":7},{"table_name":"observation","year":2014,"count":39},{"table_name":"observation","year":2015,"count":20},{"table_name":"observation","year":2016,"count":19},{"table_name":"observation","year":2017,"count":29},{"table_name":"observation","year":2018,"count":25},{"table_name":"observation","year":2019,"count":26},{"table_name":"observation","year":2020,"count":33},{"table_name":"observation","year":2021,"count":41},{"table_name":"observation","year":2022,"count":31},{"table_name":"observation","year":2023,"count":26},{"table_name":"observation","year":2024,"count":14},{"table_name":"procedure_occurrence","year":1970,"count":4},{"table_name":"procedure_occurrence","year":1971,"count":2},{"table_name":"procedure_occurrence","year":1972,"count":3},{"table_name":"procedure_occurrence","year":1973,"count":3},{"table_name":"procedure_occurrence","year":1974,"count":1},{"table_name":"procedure_occurrence","year":1975,"count":4},{"table_name":"procedure_occurrence","year":1976,"count":3},{"table_name":"procedure_occurrence","year":1977,"count":4},{"table_name":"procedure_occurrence","year":1978,"count":5},{"table_name":"procedure_occurrence","year":1979,"count":4},{"table_name":"procedure_occurrence","year":1980,"count":3},{"table_name":"procedure_occurrence","year":1981,"count":4},{"table_name":"procedure_occurrence","year":1982,"count":1},{"table_name":"procedure_occurrence","year":1983,"count":4},{"table_name":"procedure_occurrence","year":1984,"count":6},{"table_name":"procedure_occurrence","year":1985,"count":2},{"table_name":"procedure_occurrence","year":1986,"count":3},{"table_name":"procedure_occurrence","year":1987,"count":5},{"table_name":"procedure_occurrence","year":1988,"count":2},{"table_name":"procedure_occurrence","year":1989,"count":15},{"table_name":"procedure_occurrence","year":1990,"count":56},{"table_name":"procedure_occurrence","year":1991,"count":66},{"table_name":"procedure_occurrence","year":1992,"count":150},{"table_name":"procedure_occurrence","year":1993,"count":167},{"table_name":"procedure_occurrence","year":1994,"count":228},{"table_name":"procedure_occurrence","year":1995,"count":214},{"table_name":"procedure_occurrence","year":1996,"count":216},{"table_name":"procedure_occurrence","year":1997,"count":230},{"table_name":"procedure_occurrence","year":1998,"count":238},{"table_name":"procedure_occurrence","year":1999,"count":131},{"table_name":"procedure_occurrence","year":2000,"count":59},{"table_name":"procedure_occurrence","year":2001,"count":99},{"table_name":"procedure_occurrence","year":2002,"count":154},{"table_name":"procedure_occurrence","year":2003,"count":151},{"table_name":"procedure_occurrence","year":2004,"count":62},{"table_name":"procedure_occurrence","year":2005,"count":22},{"table_name":"procedure_occurrence","year":2006,"count":24},{"table_name":"procedure_occurrence","year":2007,"count":38},{"table_name":"procedure_occurrence","year":2008,"count":39},{"table_name":"procedure_occurrence","year":2009,"count":44},{"table_name":"procedure_occurrence","year":2010,"count":36},{"table_name":"procedure_occurrence","year":2011,"count":51},{"table_name":"procedure_occurrence","year":2012,"count":68},{"table_name":"procedure_occurrence","year":2013,"count":185},{"table_name":"procedure_occurrence","year":2014,"count":590},{"table_name":"procedure_occurrence","year":2015,"count":1043},{"table_name":"procedure_occurrence","year":2016,"count":997},{"table_name":"procedure_occurrence","year":2017,"count":883},{"table_name":"procedure_occurrence","year":2018,"count":1061},{"table_name":"procedure_occurrence","year":2019,"count":1173},{"table_name":"procedure_occurrence","year":2020,"count":1399},{"table_name":"procedure_occurrence","year":2021,"count":1981},{"table_name":"procedure_occurrence","year":2022,"count":1339},{"table_name":"procedure_occurrence","year":2023,"count":1292},{"table_name":"procedure_occurrence","year":2024,"count":515}]
    </script>
    <script type="application/json" id="time-series-config">
    {
        "recentStartYear": 2010,
        "recentEndYear": 2024,
        "historicalStartYear": 1970,
        "historicalEndYear": 2025,
        "deliveryYear": 2025
    }
    </script>
</div>
        <div class="section" id="delivery-report">
    <div class="section-header">
        <span class="section-icon">📋</span>
        <h2>Delivery Report</h2>
    </div>

    <div class="controls">
        <div class="control-group">
            <label class="control-label" for="table-group-selector">Select Table Group:</label>
            <select id="table-group-selector" data-action="switch-table-group">
                <option value="All Tables">All Tables</option>
<option value="Clinical Data" selected>Clinical Data</option>
<option value="Health System">Health System</option>
<option value="Healthcare Economics">Healthcare Economics</option>
<option value="Derived Data">Derived Data</option>
<option value="Vocabulary">Vocabulary</option>
<option value="Metadata">Metadata</option>
<option value="Other">Other</option>
            </select>
            <button data-action="export-table" class="export-button export-button-spaced">
                Export Counts to CSV
            </button>
        </div>
    </div>

    <div class="table-group-content" id="group-all-tables" style="display: none;">
    <h3 class="table-group-title">All Tables</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">99%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-all-tables">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="all-tables" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-all-tables">
                <tr class="clickable row-warning" data-action="show-drilldown" data-table="person">
    <td><strong>person <span class="warning-icon" title="Missing Connect ID">👤</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>110</td>
    <td><span class="harmonization-negative">-1</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>109</td>
    <td>1.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="visit_occurrence">
    <td><strong>visit_occurrence</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="visit_detail">
    <td><strong>visit_detail</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="condition_occurrence">
    <td><strong>condition_occurrence <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+163</span></td>
    <td>163</td>
    <td>1.50</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="drug_exposure">
    <td><strong>drug_exposure <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>12,690</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+72</span></td>
    <td>12,762</td>
    <td>117.08</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="procedure_occurrence">
    <td><strong>procedure_occurrence <span class="warning-icon" title="Row count mismatch">🧮</span> <span class="warning-icon" title="Default/placeholder dates">📅</span> <span class="warning-icon" title="Invalid concept IDs">📖</span> <span class="warning-icon" title="Invalid data type specifications">🧩</span> <span class="warning-icon" title="Missing Connect ID">👤</span> <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>15,754</td>
    <td><span class="harmonization-negative">-4</span></td>
    <td><span class="harmonization-negative">-599</span></td>
    <td>15,152</td>
    <td>139.01</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="device_exposure">
    <td><strong>device_exposure</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="measurement">
    <td><strong>measurement <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>62,073</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+5</span></td>
    <td>62,078</td>
    <td>569.52</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="observation">
    <td><strong>observation <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+361</span></td>
    <td>361</td>
    <td>3.31</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="specimen">
    <td><strong>specimen</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="note">
    <td><strong>note</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="death">
    <td><strong>death</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="care_site">
    <td><strong>care_site</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="location">
    <td><strong>location</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="provider">
    <td><strong>provider</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cost">
    <td><strong>cost</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="payer_plan_period">
    <td><strong>payer_plan_period</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="condition_era">
    <td><strong>condition_era <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>29</td>
    <td>0.27</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="dose_era">
    <td><strong>dose_era</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="drug_era">
    <td><strong>drug_era <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>972</td>
    <td>8.92</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="observation_period">
    <td><strong>observation_period <span class="warning-icon" title="Default/placeholder dates">📅</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>109</td>
    <td>1.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept">
    <td><strong>concept</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_ancestor">
    <td><strong>concept_ancestor</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_class">
    <td><strong>concept_class</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_relationship">
    <td><strong>concept_relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_synonym">
    <td><strong>concept_synonym</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="domain">
    <td><strong>domain</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="drug_strength">
    <td><strong>drug_strength</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="relationship">
    <td><strong>relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="source_to_concept_map">
    <td><strong>source_to_concept_map</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="vocabulary">
    <td><strong>vocabulary</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cdm_source">
    <td><strong>cdm_source</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>1</td>
    <td>0.01</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="metadata">
    <td><strong>metadata</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="attribute_definition">
    <td><strong>attribute_definition</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cohort">
    <td><strong>cohort</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cohort_definition">
    <td><strong>cohort_definition</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="episode">
    <td><strong>episode</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="episode_event">
    <td><strong>episode_event</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="fact_relationship">
    <td><strong>fact_relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="note_nlp">
    <td><strong>note_nlp</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">All Tables</div>
        <div id="group-type-concepts-all-tables" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-clinical-data" style="">
    <h3 class="table-group-title">Clinical Data</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">98%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-clinical-data">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="clinical-data" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-clinical-data">
                <tr class="clickable row-warning" data-action="show-drilldown" data-table="person">
    <td><strong>person <span class="warning-icon" title="Missing Connect ID">👤</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>110</td>
    <td><span class="harmonization-negative">-1</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>109</td>
    <td>1.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="visit_occurrence">
    <td><strong>visit_occurrence</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="visit_detail">
    <td><strong>visit_detail</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="condition_occurrence">
    <td><strong>condition_occurrence <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+163</span></td>
    <td>163</td>
    <td>1.50</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="drug_exposure">
    <td><strong>drug_exposure <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>12,690</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+72</span></td>
    <td>12,762</td>
    <td>117.08</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="procedure_occurrence">
    <td><strong>procedure_occurrence <span class="warning-icon" title="Row count mismatch">🧮</span> <span class="warning-icon" title="Default/placeholder dates">📅</span> <span class="warning-icon" title="Invalid concept IDs">📖</span> <span class="warning-icon" title="Invalid data type specifications">🧩</span> <span class="warning-icon" title="Missing Connect ID">👤</span> <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>15,754</td>
    <td><span class="harmonization-negative">-4</span></td>
    <td><span class="harmonization-negative">-599</span></td>
    <td>15,152</td>
    <td>139.01</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="device_exposure">
    <td><strong>device_exposure</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="measurement">
    <td><strong>measurement <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-delivered">Delivered</span></td>
    <td>62,073</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+5</span></td>
    <td>62,078</td>
    <td>569.52</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="observation">
    <td><strong>observation <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-positive">+361</span></td>
    <td>361</td>
    <td>3.31</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="specimen">
    <td><strong>specimen</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="note">
    <td><strong>note</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">0</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="death">
    <td><strong>death</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Clinical Data Tables</div>
        <div id="group-type-concepts-clinical-data" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-health-system" style="display: none;">
    <h3 class="table-group-title">Health System</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">100%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-health-system">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="health-system" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-health-system">
                <tr class="clickable " data-action="show-drilldown" data-table="care_site">
    <td><strong>care_site</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="location">
    <td><strong>location</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="provider">
    <td><strong>provider</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Health System Tables</div>
        <div id="group-type-concepts-health-system" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-healthcare-economics" style="display: none;">
    <h3 class="table-group-title">Healthcare Economics</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">100%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-healthcare-economics">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="healthcare-economics" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-healthcare-economics">
                <tr class="clickable " data-action="show-drilldown" data-table="cost">
    <td><strong>cost</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="payer_plan_period">
    <td><strong>payer_plan_period</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Healthcare Economics Tables</div>
        <div id="group-type-concepts-healthcare-economics" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-derived-data" style="display: none;">
    <h3 class="table-group-title">Derived Data</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">98%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-derived-data">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="derived-data" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-derived-data">
                <tr class="clickable row-warning" data-action="show-drilldown" data-table="condition_era">
    <td><strong>condition_era <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>29</td>
    <td>0.27</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="dose_era">
    <td><strong>dose_era</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="drug_era">
    <td><strong>drug_era <span class="warning-icon" title="Referential integrity violations">🧑‍🧒</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>972</td>
    <td>8.92</td>
</tr>
<tr class="clickable row-warning" data-action="show-drilldown" data-table="observation_period">
    <td><strong>observation_period <span class="warning-icon" title="Default/placeholder dates">📅</span></strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>109</td>
    <td>1.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Derived Data Tables</div>
        <div id="group-type-concepts-derived-data" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-vocabulary" style="display: none;">
    <h3 class="table-group-title">Vocabulary</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">100%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-vocabulary">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="vocabulary" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-vocabulary">
                <tr class="clickable " data-action="show-drilldown" data-table="concept">
    <td><strong>concept</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_ancestor">
    <td><strong>concept_ancestor</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_class">
    <td><strong>concept_class</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_relationship">
    <td><strong>concept_relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="concept_synonym">
    <td><strong>concept_synonym</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="domain">
    <td><strong>domain</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="drug_strength">
    <td><strong>drug_strength</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="relationship">
    <td><strong>relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="source_to_concept_map">
    <td><strong>source_to_concept_map</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="vocabulary">
    <td><strong>vocabulary</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Vocabulary Tables</div>
        <div id="group-type-concepts-vocabulary" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-metadata" style="display: none;">
    <h3 class="table-group-title">Metadata</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">100%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-metadata">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="metadata" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-metadata">
                <tr class="clickable " data-action="show-drilldown" data-table="cdm_source">
    <td><strong>cdm_source</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>1</td>
    <td>0.01</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="metadata">
    <td><strong>metadata</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Metadata Tables</div>
        <div id="group-type-concepts-metadata" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
<div class="table-group-content" id="group-other" style="display: none;">
    <h3 class="table-group-title">Other</h3>

    <p class="dqd-score-text"><strong>Data Quality Score for this group:</strong> <span class="dqd-inline">100%</span></p>

    <h4 class="table-group-subtitle">Table Delivery Summary</h4>
    <div class="table-container">
        <table id="delivery-table-other">
            <thead>
                <tr>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="0" data-sort-type="text">Table Name <span class="sort-indicator"></span></th>
                    <th>Status</th>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="2" data-sort-type="number">Initial Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="3" data-sort-type="number">Quality Issues <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="4" data-sort-type="number">Harmonization <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="5" data-sort-type="number">Final Rows <span class="sort-indicator"></span></th>
                    <th class="sortable" data-action="sort-table" data-group="other" data-column="6" data-sort-type="number">Row-Per-Patient <span class="sort-indicator"></span></th>
                </tr>
            </thead>
            <tbody id="delivery-tbody-other">
                <tr class="clickable " data-action="show-drilldown" data-table="attribute_definition">
    <td><strong>attribute_definition</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cohort">
    <td><strong>cohort</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="cohort_definition">
    <td><strong>cohort_definition</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="episode">
    <td><strong>episode</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="episode_event">
    <td><strong>episode_event</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="fact_relationship">
    <td><strong>fact_relationship</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
<tr class="clickable " data-action="show-drilldown" data-table="note_nlp">
    <td><strong>note_nlp</strong></td>
    <td><span class="status-badge status-not-delivered">Not Delivered</span></td>
    <td>0</td>
    <td><span class="harmonization-neutral">0</span></td>
    <td><span class="harmonization-neutral">--</span></td>
    <td>0</td>
    <td>0.00</td>
</tr>
            </tbody>
        </table>
    </div>

    <div class="subsection">
        <h4 class="type-concepts-header">Type Concept Breakdown</h4>
        <div class="type-concepts-disclaimer">Other Tables</div>
        <div id="group-type-concepts-other" class="chart-container type-concepts-container">
            <!-- Dynamically populated by JavaScript -->
        </div>
    </div>
</div>
</div>
        <div class="section" id="vocab-harmonization">
    <div class="section-header">
        <span class="section-icon"></span>
        <h2>Vocabulary Harmonization</h2>
    </div>

    <div class="vocab-versions-container">
        <div class="metric-card vocab-metric-card">
            <div class="metric-label">Delivered Vocabulary Version</div>
            <div class="metric-value vocab-metric-value-lg">No vocabulary file provided</div>
        </div>

        <div class="metric-card vocab-metric-card">
            <div class="metric-label">Standardized to Vocabulary Version</div>
            <div class="metric-value vocab-metric-value-lg">v5.0 27-AUG-25</div>
        </div>
    </div>

    <div id="vocab-harm-content">
        <!-- Dynamically populated by JavaScript -->
    </div>

    <div class="subsection vocab-subsection-spacing">
        <div class="vocab-tables-grid">
            <div>
                <h4 class="vocab-table-heading">Top Source Vocabularies</h4>
                <div class="table-container vocab-table-bordered">
                    <table class="vocab-table">
                        <thead class="vocab-table-header-gradient">
                            <tr>
                                <th>Vocabulary</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>None</td><td>62,405</td></tr>
<tr><td>LOINC</td><td>54,100</td></tr>
<tr><td>SNOMED</td><td>23,720</td></tr>
<tr><td>RxNorm</td><td>9,584</td></tr>
<tr><td>CVX</td><td>3,106</td></tr>
<tr><td>ICD10CN</td><td>3</td></tr>
<tr><td>Read</td><td>2</td></tr>
<tr><td>Source vocabulary not captured in OMOP</td><td>0</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div>
                <h4 class="vocab-table-heading">Top Target Vocabularies</h4>
                <div class="table-container vocab-table-bordered">
                    <table class="vocab-table">
                        <thead class="vocab-table-header-gradient">
                            <tr>
                                <th>Vocabulary</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>None</td><td>172,975</td></tr>
<tr><td>LOINC</td><td>54,100</td></tr>
<tr><td>UCUM</td><td>40,157</td></tr>
<tr><td>SNOMED</td><td>25,933</td></tr>
<tr><td>RxNorm</td><td>9,844</td></tr>
<tr><td>CVX</td><td>2,918</td></tr>
<tr><td>Gender</td><td>109</td></tr>
<tr><td>Race</td><td>104</td></tr>
<tr><td>Ethnicity</td><td>95</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
        <div class="section drill-down" id="table-drilldown" style="display: none;">
    <button class="back-button" data-action="hide-drilldown">← Back to Delivery Report</button>

    <div class="section-header">
        <div>
            <h2 id="drilldown-table-name">Table Name</h2>
            <div class="drilldown-subtitle">Table Drilldown Report</div>
        </div>
    </div>

    <div id="drilldown-content">
        <!-- Dynamically populated by JavaScript -->
    </div>
</div>
        <div class="section" id="technical-summary">
    <div class="section-header">
        <span class="section-icon">⚙️</span>
        <h2>Technical Summary</h2>
    </div>

    <div class="tech-summary-metrics">
        <div class="metric-card tech-summary-metric-card">
            <div class="metric-label">Processing Date</div>
            <div class="metric-value tech-summary-metric-value-lg">2026-01-02</div>
        </div>

        <div class="metric-card tech-summary-metric-card">
            <div class="metric-label">Delivered CDM Version</div>
            <div class="metric-value tech-summary-metric-value-lg">5.3</div>
        </div>

        <div class="metric-card tech-summary-metric-card">
            <div class="metric-label">Standardized CDM Version</div>
            <div class="metric-value tech-summary-metric-value-lg">5.4</div>
        </div>

        <div class="metric-card tech-summary-metric-card">
            <div class="metric-label">File Format</div>
            <div class="metric-value tech-summary-metric-value-lg">.CSV</div>
        </div>
    </div>
    <p class="tech-summary-footer">Pipeline Version: 84ece92b368c7c29f4448f46b16b6577f820baf7</p>
</div>
    </div>

    <script>
    // Report data for JavaScript
    const REPORT_DATA = {"groups":{"All Tables":{"tables":{"person":{"name":"person","delivered":true,"valid_rows":109,"invalid_rows":0,"initial_rows":110,"final_rows":109,"missing_person_id_rows":1,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":-109,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0.9091,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":1,"type_concepts":[],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"person","column_name":"gender_concept_id","vocabulary":"None","count":109},{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"None","count":109},{"table_name":"person","column_name":"race_concept_id","vocabulary":"None","count":109}],"target_vocabularies":[{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"Ethnicity","count":95},{"table_name":"person","column_name":"race_concept_id","vocabulary":"Race","count":104},{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"None","count":14},{"table_name":"person","column_name":"race_concept_id","vocabulary":"None","count":5},{"table_name":"person","column_name":"gender_concept_id","vocabulary":"Gender","count":109}],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0.8392,"pass_metrics":[{"metric":"accessibility","score":0.9669,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.64,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"provenance","score":0.75,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"}],"counts_valid":true,"expected_final":109},"visit_occurrence":{"name":"visit_occurrence","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"visit_detail":{"name":"visit_detail","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"condition_occurrence":{"name":"condition_occurrence","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":163,"missing_person_id_rows":0,"referential_integrity_violations":1,"harmonization":163,"transitions_in":163,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0.6135,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"condition_occurrence","type_concept":"EHR","count":22,"type_group":"EHR"},{"table_name":"condition_occurrence","type_concept":"EHR chief complaint","count":20,"type_group":"EHR"},{"table_name":"condition_occurrence","type_concept":"No matching concept","count":121,"type_group":"Unlabeled"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[{"table_name":"condition_occurrence","column_name":"condition_concept_id","vocabulary":"SNOMED","count":163},{"table_name":"condition_occurrence","column_name":"condition_status_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"condition_occurrence","column_name":"condition_status_concept_id","vocabulary":"None","count":163},{"table_name":"condition_occurrence","column_name":"condition_concept_id","vocabulary":"SNOMED","count":163}],"transitions":[{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163}],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0.6731,"pass_metrics":[{"metric":"accessibility","score":0.9091,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.4866,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":1,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.6428,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.972,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.429,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.5273,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":163},"drug_exposure":{"name":"drug_exposure","delivered":true,"valid_rows":12690,"invalid_rows":0,"initial_rows":12690,"final_rows":12762,"missing_person_id_rows":0,"referential_integrity_violations":170,"harmonization":72,"transitions_in":72,"rows_out":0,"same_table_result_rows":12690,"rows_added_from_mappings":0,"total_harmonization_status_rows":258,"harmonization_percent":2,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":1.3321,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"drug_exposure","type_concept":"EHR","count":6381,"type_group":"EHR"},{"table_name":"drug_exposure","type_concept":"No matching concept","count":6381,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"RxNorm","count":9584},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"SNOMED","count":72},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"CVX","count":3106},{"table_name":"drug_exposure","column_name":"route_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"RxNorm","count":9844},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"CVX","count":2918},{"table_name":"drug_exposure","column_name":"route_concept_id","vocabulary":"None","count":12762}],"transitions":[{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72},{"source_table":"drug_exposure","target_table":"drug_exposure","count":12690}],"harmonization_statuses":[{"table_name":"drug_exposure","status":"source_concept_id mapped to new target","count":258}],"dispositions":[{"table_name":"drug_exposure","disposition":"stayed only","count":12293}],"same_table_mappings":[{"table_name":"drug_exposure","mapping":"Vocab harmonization same-table mapping: drug_exposure - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":12690,"rows_added":0}],"dqd_score":97,"pass_score":0.772,"pass_metrics":[{"metric":"accessibility","score":0.9091,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.6821,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9987,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.7583,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.8132,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4662,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":12762},"procedure_occurrence":{"name":"procedure_occurrence","delivered":true,"valid_rows":15750,"invalid_rows":2,"initial_rows":15754,"final_rows":15152,"missing_person_id_rows":2,"referential_integrity_violations":215,"harmonization":-599,"transitions_in":0,"rows_out":599,"same_table_result_rows":15151,"rows_added_from_mappings":0,"total_harmonization_status_rows":283,"harmonization_percent":2,"default_date_rows":2036,"invalid_concept_rows":1,"default_date_percent":13.4372,"invalid_concept_percent":0.0066,"missing_person_id_percent":0.0127,"referential_integrity_percent":1.419,"invalid_rows_percent":0.0127,"quality_issues":4,"type_concepts":[{"table_name":"procedure_occurrence","type_concept":"EHR","count":6700,"type_group":"EHR"},{"table_name":"procedure_occurrence","type_concept":"No matching concept","count":8451,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":["visit_detail_id"],"source_vocabularies":[{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"SNOMED","count":15149},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"LOINC","count":2},{"table_name":"procedure_occurrence","column_name":"modifier_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"None","count":20},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"SNOMED","count":15129},{"table_name":"procedure_occurrence","column_name":"modifier_concept_id","vocabulary":"None","count":15151},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"LOINC","count":2}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"procedure_occurrence","target_table":"procedure_occurrence","count":15151},{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163},{"source_table":"procedure_occurrence","target_table":"measurement","count":4},{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72}],"harmonization_statuses":[{"table_name":"procedure_occurrence","status":"source_concept_id mapped to new target","count":283}],"dispositions":[{"table_name":"procedure_occurrence","disposition":"stayed only","count":14526},{"table_name":"procedure_occurrence","disposition":"moved to other tables","count":519}],"same_table_mappings":[{"table_name":"procedure_occurrence","mapping":"Vocab harmonization same-table mapping: procedure_occurrence - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":15151,"rows_added":0}],"dqd_score":97,"pass_score":0.7069,"pass_metrics":[{"metric":"accessibility","score":0.6662,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.6276,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9998,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.664,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.4974,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4989,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":false,"expected_final":15151},"device_exposure":{"name":"device_exposure","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"measurement":{"name":"measurement","delivered":true,"valid_rows":62073,"invalid_rows":0,"initial_rows":62073,"final_rows":62078,"missing_person_id_rows":0,"referential_integrity_violations":773,"harmonization":5,"transitions_in":4,"rows_out":1,"same_table_result_rows":62074,"rows_added_from_mappings":2,"total_harmonization_status_rows":877,"harmonization_percent":1,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":1.2452,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"measurement","type_concept":"EHR","count":58044,"type_group":"EHR"},{"table_name":"measurement","type_concept":"EHR chief complaint","count":49,"type_group":"EHR"},{"table_name":"measurement","type_concept":"No matching concept","count":3985,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"Read","count":1},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"LOINC","count":54098},{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"None","count":62078},{"table_name":"measurement","column_name":"operator_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"ICD10CN","count":3},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"SNOMED","count":7976}],"target_vocabularies":[{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"None","count":59778},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"UCUM","count":40157},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"LOINC","count":54098},{"table_name":"measurement","column_name":"operator_concept_id","vocabulary":"None","count":62078},{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"SNOMED","count":2300},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"SNOMED","count":7980},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"None","count":21921}],"transitions":[{"source_table":"measurement","target_table":"measurement","count":62074},{"source_table":"measurement","target_table":"observation","count":1},{"source_table":"procedure_occurrence","target_table":"measurement","count":4}],"harmonization_statuses":[{"table_name":"measurement","status":"source_concept_id mapped to new target","count":872},{"table_name":"measurement","status":"existing non-standard target remapped to standard code","count":5}],"dispositions":[{"table_name":"measurement","disposition":"stayed and copied","count":1},{"table_name":"measurement","disposition":"stayed only","count":62049}],"same_table_mappings":[{"table_name":"measurement","mapping":"Vocab harmonization same-table mapping: measurement - 1:2","source_multiplier":1,"target_multiplier":2,"total_rows":2,"rows_added":1},{"table_name":"measurement","mapping":"Vocab harmonization same-table mapping: measurement - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":62072,"rows_added":0}],"dqd_score":98,"pass_score":0.7935,"pass_metrics":[{"metric":"accessibility","score":0.7866,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.7615,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.4866,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9002,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.8262,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":1,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4829,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":62078},"observation":{"name":"observation","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":361,"missing_person_id_rows":0,"referential_integrity_violations":10,"harmonization":361,"transitions_in":361,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":2.7701,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"observation","type_concept":"EHR","count":17,"type_group":"EHR"},{"table_name":"observation","type_concept":"No matching concept","count":344,"type_group":"Unlabeled"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[{"table_name":"observation","column_name":"value_as_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"unit_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"qualifier_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"SNOMED","count":360},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"Read","count":1}],"target_vocabularies":[{"table_name":"observation","column_name":"value_as_concept_id","vocabulary":"None","count":361},{"table_name":"observation","column_name":"unit_concept_id","vocabulary":"None","count":361},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"SNOMED","count":361},{"table_name":"observation","column_name":"qualifier_concept_id","vocabulary":"None","count":361}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"measurement","target_table":"observation","count":1}],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":95,"pass_score":0.649,"pass_metrics":[{"metric":"accessibility","score":0.4545,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.5344,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9999,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.6215,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9698,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.1064,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.7884,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":361},"specimen":{"name":"specimen","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"note":{"name":"note","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"death":{"name":"death","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"care_site":{"name":"care_site","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"location":{"name":"location","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"provider":{"name":"provider","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"cost":{"name":"cost","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"payer_plan_period":{"name":"payer_plan_period","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"condition_era":{"name":"condition_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":29,"missing_person_id_rows":0,"referential_integrity_violations":1,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":3.4483,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"dose_era":{"name":"dose_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"drug_era":{"name":"drug_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":972,"missing_person_id_rows":0,"referential_integrity_violations":22,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":2.2634,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":98,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"observation_period":{"name":"observation_period","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":109,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":109,"invalid_concept_rows":0,"default_date_percent":100,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"observation_period","type_concept":"Standard algorithm from EHR","count":109,"type_group":"EHR"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":95,"pass_score":0.2835,"pass_metrics":[{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"}],"counts_valid":true,"expected_final":109},"concept":{"name":"concept","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_ancestor":{"name":"concept_ancestor","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_class":{"name":"concept_class","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_relationship":{"name":"concept_relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_synonym":{"name":"concept_synonym","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"domain":{"name":"domain","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"drug_strength":{"name":"drug_strength","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":98,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"relationship":{"name":"relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"source_to_concept_map":{"name":"source_to_concept_map","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"vocabulary":{"name":"vocabulary","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"cdm_source":{"name":"cdm_source","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":1,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"metadata":{"name":"metadata","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"attribute_definition":{"name":"attribute_definition","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":null,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"cohort":{"name":"cohort","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"cohort_definition":{"name":"cohort_definition","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"episode":{"name":"episode","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"episode_event":{"name":"episode_event","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"fact_relationship":{"name":"fact_relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"note_nlp":{"name":"note_nlp","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0}},"dqd_score":99,"source_vocabularies":[{"vocabulary":"None","count":62405},{"vocabulary":"LOINC","count":54100},{"vocabulary":"SNOMED","count":23720},{"vocabulary":"RxNorm","count":9584},{"vocabulary":"CVX","count":3106},{"vocabulary":"ICD10CN","count":3},{"vocabulary":"Read","count":2},{"vocabulary":"Source vocabulary not captured in OMOP","count":0}],"target_vocabularies":[{"vocabulary":"None","count":172975},{"vocabulary":"LOINC","count":54100},{"vocabulary":"UCUM","count":40157},{"vocabulary":"SNOMED","count":25933},{"vocabulary":"RxNorm","count":9844},{"vocabulary":"CVX","count":2918},{"vocabulary":"Gender","count":109},{"vocabulary":"Race","count":104},{"vocabulary":"Ethnicity","count":95}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"procedure_occurrence","target_table":"procedure_occurrence","count":15151},{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163},{"source_table":"measurement","target_table":"measurement","count":62074},{"source_table":"measurement","target_table":"observation","count":1},{"source_table":"procedure_occurrence","target_table":"measurement","count":4},{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72},{"source_table":"drug_exposure","target_table":"drug_exposure","count":12690}],"transition_stats":{"total_rows":90515,"same_table_count":89915,"cross_table_count":600},"type_concepts":[{"type_group":"EHR","type_concept":"EHR","count":71164},{"type_group":"EHR","type_concept":"Standard algorithm from EHR","count":109},{"type_group":"EHR","type_concept":"EHR chief complaint","count":69},{"type_group":"Unlabeled","type_concept":"No matching concept","count":19282}],"type_concepts_summary":[{"type_group":"EHR","count":71342,"percent":78.7231},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":19282,"percent":21.2769}]},"Clinical Data":{"tables":{"person":{"name":"person","delivered":true,"valid_rows":109,"invalid_rows":0,"initial_rows":110,"final_rows":109,"missing_person_id_rows":1,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":-109,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0.9091,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":1,"type_concepts":[],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"person","column_name":"gender_concept_id","vocabulary":"None","count":109},{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"None","count":109},{"table_name":"person","column_name":"race_concept_id","vocabulary":"None","count":109}],"target_vocabularies":[{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"Ethnicity","count":95},{"table_name":"person","column_name":"race_concept_id","vocabulary":"Race","count":104},{"table_name":"person","column_name":"ethnicity_concept_id","vocabulary":"None","count":14},{"table_name":"person","column_name":"race_concept_id","vocabulary":"None","count":5},{"table_name":"person","column_name":"gender_concept_id","vocabulary":"Gender","count":109}],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0.8392,"pass_metrics":[{"metric":"accessibility","score":0.9669,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.64,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"provenance","score":0.75,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"}],"counts_valid":true,"expected_final":109},"visit_occurrence":{"name":"visit_occurrence","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"visit_detail":{"name":"visit_detail","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"condition_occurrence":{"name":"condition_occurrence","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":163,"missing_person_id_rows":0,"referential_integrity_violations":1,"harmonization":163,"transitions_in":163,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0.6135,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"condition_occurrence","type_concept":"EHR","count":22,"type_group":"EHR"},{"table_name":"condition_occurrence","type_concept":"EHR chief complaint","count":20,"type_group":"EHR"},{"table_name":"condition_occurrence","type_concept":"No matching concept","count":121,"type_group":"Unlabeled"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[{"table_name":"condition_occurrence","column_name":"condition_concept_id","vocabulary":"SNOMED","count":163},{"table_name":"condition_occurrence","column_name":"condition_status_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"condition_occurrence","column_name":"condition_status_concept_id","vocabulary":"None","count":163},{"table_name":"condition_occurrence","column_name":"condition_concept_id","vocabulary":"SNOMED","count":163}],"transitions":[{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163}],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":99,"pass_score":0.6731,"pass_metrics":[{"metric":"accessibility","score":0.9091,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.4866,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":1,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.6428,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.972,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.429,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.5273,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":163},"drug_exposure":{"name":"drug_exposure","delivered":true,"valid_rows":12690,"invalid_rows":0,"initial_rows":12690,"final_rows":12762,"missing_person_id_rows":0,"referential_integrity_violations":170,"harmonization":72,"transitions_in":72,"rows_out":0,"same_table_result_rows":12690,"rows_added_from_mappings":0,"total_harmonization_status_rows":258,"harmonization_percent":2,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":1.3321,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"drug_exposure","type_concept":"EHR","count":6381,"type_group":"EHR"},{"table_name":"drug_exposure","type_concept":"No matching concept","count":6381,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"RxNorm","count":9584},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"SNOMED","count":72},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"CVX","count":3106},{"table_name":"drug_exposure","column_name":"route_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"RxNorm","count":9844},{"table_name":"drug_exposure","column_name":"drug_concept_id","vocabulary":"CVX","count":2918},{"table_name":"drug_exposure","column_name":"route_concept_id","vocabulary":"None","count":12762}],"transitions":[{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72},{"source_table":"drug_exposure","target_table":"drug_exposure","count":12690}],"harmonization_statuses":[{"table_name":"drug_exposure","status":"source_concept_id mapped to new target","count":258}],"dispositions":[{"table_name":"drug_exposure","disposition":"stayed only","count":12293}],"same_table_mappings":[{"table_name":"drug_exposure","mapping":"Vocab harmonization same-table mapping: drug_exposure - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":12690,"rows_added":0}],"dqd_score":97,"pass_score":0.772,"pass_metrics":[{"metric":"accessibility","score":0.9091,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.6821,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9987,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.7583,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.8132,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4662,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":12762},"procedure_occurrence":{"name":"procedure_occurrence","delivered":true,"valid_rows":15750,"invalid_rows":2,"initial_rows":15754,"final_rows":15152,"missing_person_id_rows":2,"referential_integrity_violations":215,"harmonization":-599,"transitions_in":0,"rows_out":599,"same_table_result_rows":15151,"rows_added_from_mappings":0,"total_harmonization_status_rows":283,"harmonization_percent":2,"default_date_rows":2036,"invalid_concept_rows":1,"default_date_percent":13.4372,"invalid_concept_percent":0.0066,"missing_person_id_percent":0.0127,"referential_integrity_percent":1.419,"invalid_rows_percent":0.0127,"quality_issues":4,"type_concepts":[{"table_name":"procedure_occurrence","type_concept":"EHR","count":6700,"type_group":"EHR"},{"table_name":"procedure_occurrence","type_concept":"No matching concept","count":8451,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":["visit_detail_id"],"source_vocabularies":[{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"SNOMED","count":15149},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"LOINC","count":2},{"table_name":"procedure_occurrence","column_name":"modifier_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null}],"target_vocabularies":[{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"None","count":20},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"SNOMED","count":15129},{"table_name":"procedure_occurrence","column_name":"modifier_concept_id","vocabulary":"None","count":15151},{"table_name":"procedure_occurrence","column_name":"procedure_concept_id","vocabulary":"LOINC","count":2}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"procedure_occurrence","target_table":"procedure_occurrence","count":15151},{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163},{"source_table":"procedure_occurrence","target_table":"measurement","count":4},{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72}],"harmonization_statuses":[{"table_name":"procedure_occurrence","status":"source_concept_id mapped to new target","count":283}],"dispositions":[{"table_name":"procedure_occurrence","disposition":"stayed only","count":14526},{"table_name":"procedure_occurrence","disposition":"moved to other tables","count":519}],"same_table_mappings":[{"table_name":"procedure_occurrence","mapping":"Vocab harmonization same-table mapping: procedure_occurrence - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":15151,"rows_added":0}],"dqd_score":97,"pass_score":0.7069,"pass_metrics":[{"metric":"accessibility","score":0.6662,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.6276,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9998,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.664,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.4974,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4989,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":false,"expected_final":15151},"device_exposure":{"name":"device_exposure","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"measurement":{"name":"measurement","delivered":true,"valid_rows":62073,"invalid_rows":0,"initial_rows":62073,"final_rows":62078,"missing_person_id_rows":0,"referential_integrity_violations":773,"harmonization":5,"transitions_in":4,"rows_out":1,"same_table_result_rows":62074,"rows_added_from_mappings":2,"total_harmonization_status_rows":877,"harmonization_percent":1,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":1.2452,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"measurement","type_concept":"EHR","count":58044,"type_group":"EHR"},{"table_name":"measurement","type_concept":"EHR chief complaint","count":49,"type_group":"EHR"},{"table_name":"measurement","type_concept":"No matching concept","count":3985,"type_group":"Unlabeled"}],"invalid_columns":["src_id"],"missing_columns":[],"source_vocabularies":[{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"Read","count":1},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"LOINC","count":54098},{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"None","count":62078},{"table_name":"measurement","column_name":"operator_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"ICD10CN","count":3},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"SNOMED","count":7976}],"target_vocabularies":[{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"None","count":59778},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"UCUM","count":40157},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"LOINC","count":54098},{"table_name":"measurement","column_name":"operator_concept_id","vocabulary":"None","count":62078},{"table_name":"measurement","column_name":"value_as_concept_id","vocabulary":"SNOMED","count":2300},{"table_name":"measurement","column_name":"measurement_concept_id","vocabulary":"SNOMED","count":7980},{"table_name":"measurement","column_name":"unit_concept_id","vocabulary":"None","count":21921}],"transitions":[{"source_table":"measurement","target_table":"measurement","count":62074},{"source_table":"measurement","target_table":"observation","count":1},{"source_table":"procedure_occurrence","target_table":"measurement","count":4}],"harmonization_statuses":[{"table_name":"measurement","status":"source_concept_id mapped to new target","count":872},{"table_name":"measurement","status":"existing non-standard target remapped to standard code","count":5}],"dispositions":[{"table_name":"measurement","disposition":"stayed and copied","count":1},{"table_name":"measurement","disposition":"stayed only","count":62049}],"same_table_mappings":[{"table_name":"measurement","mapping":"Vocab harmonization same-table mapping: measurement - 1:2","source_multiplier":1,"target_multiplier":2,"total_rows":2,"rows_added":1},{"table_name":"measurement","mapping":"Vocab harmonization same-table mapping: measurement - 1:1","source_multiplier":1,"target_multiplier":1,"total_rows":62072,"rows_added":0}],"dqd_score":98,"pass_score":0.7935,"pass_metrics":[{"metric":"accessibility","score":0.7866,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.7615,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.4866,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9002,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.8262,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9956,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":1,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.4829,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":62078},"observation":{"name":"observation","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":361,"missing_person_id_rows":0,"referential_integrity_violations":10,"harmonization":361,"transitions_in":361,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":2.7701,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"observation","type_concept":"EHR","count":17,"type_group":"EHR"},{"table_name":"observation","type_concept":"No matching concept","count":344,"type_group":"Unlabeled"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[{"table_name":"observation","column_name":"value_as_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"unit_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"qualifier_concept_id","vocabulary":"Source vocabulary not captured in OMOP","count":null},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"SNOMED","count":360},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"Read","count":1}],"target_vocabularies":[{"table_name":"observation","column_name":"value_as_concept_id","vocabulary":"None","count":361},{"table_name":"observation","column_name":"unit_concept_id","vocabulary":"None","count":361},{"table_name":"observation","column_name":"observation_concept_id","vocabulary":"SNOMED","count":361},{"table_name":"observation","column_name":"qualifier_concept_id","vocabulary":"None","count":361}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"measurement","target_table":"observation","count":1}],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":95,"pass_score":0.649,"pass_metrics":[{"metric":"accessibility","score":0.4545,"description":"Evaluates whether clinical data is present and accessible for analysis"},{"metric":"concept_diversity","score":0.5344,"description":"Quantifies the variety of distinct clinical concepts captured in the data"},{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"},{"metric":"provenance","score":0.9999,"description":"Evaluates information preservation and traceability through the mapping process"},{"metric":"standards","score":1,"description":"Measures use of standardized vocabularies required for interoperable research"},{"metric":"temporal","score":0.6215,"description":"Assesses data distribution over time including span, density, and consistency"},{"metric":"temporal_range","score":0.9698,"description":"Historical span of data, measured in years"},{"metric":"temporal_density","score":0.1064,"description":"Average volume of clinical records per patient over time"},{"metric":"temporal_consistency","score":0.7884,"description":"Stability of data capture over time, detecting gaps or irregular patterns"}],"counts_valid":true,"expected_final":361},"specimen":{"name":"specimen","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"note":{"name":"note","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"death":{"name":"death","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0}},"dqd_score":98,"source_vocabularies":[{"vocabulary":"None","count":62405},{"vocabulary":"LOINC","count":54100},{"vocabulary":"SNOMED","count":23720},{"vocabulary":"RxNorm","count":9584},{"vocabulary":"CVX","count":3106},{"vocabulary":"ICD10CN","count":3},{"vocabulary":"Read","count":2},{"vocabulary":"Source vocabulary not captured in OMOP","count":0}],"target_vocabularies":[{"vocabulary":"None","count":172975},{"vocabulary":"LOINC","count":54100},{"vocabulary":"UCUM","count":40157},{"vocabulary":"SNOMED","count":25933},{"vocabulary":"RxNorm","count":9844},{"vocabulary":"CVX","count":2918},{"vocabulary":"Gender","count":109},{"vocabulary":"Race","count":104},{"vocabulary":"Ethnicity","count":95}],"transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"procedure_occurrence","target_table":"procedure_occurrence","count":15151},{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163},{"source_table":"measurement","target_table":"measurement","count":62074},{"source_table":"measurement","target_table":"observation","count":1},{"source_table":"procedure_occurrence","target_table":"measurement","count":4},{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72},{"source_table":"drug_exposure","target_table":"drug_exposure","count":12690}],"transition_stats":{"total_rows":90515,"same_table_count":89915,"cross_table_count":600},"type_concepts":[{"type_group":"EHR","type_concept":"EHR","count":71164},{"type_group":"EHR","type_concept":"EHR chief complaint","count":69},{"type_group":"Unlabeled","type_concept":"No matching concept","count":19282}],"type_concepts_summary":[{"type_group":"EHR","count":71233,"percent":78.6975},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":19282,"percent":21.3025}]},"Health System":{"tables":{"care_site":{"name":"care_site","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"location":{"name":"location","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"provider":{"name":"provider","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0}},"dqd_score":100,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[],"type_concepts_summary":[{"type_group":"EHR","count":0,"percent":0},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]},"Healthcare Economics":{"tables":{"cost":{"name":"cost","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0},"payer_plan_period":{"name":"payer_plan_period","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":0,"pass_metrics":[{"metric":"accessibility","score":0,"description":"Evaluates whether clinical data is present and accessible for analysis"}],"counts_valid":true,"expected_final":0}},"dqd_score":100,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[],"type_concepts_summary":[{"type_group":"EHR","count":0,"percent":0},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]},"Derived Data":{"tables":{"condition_era":{"name":"condition_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":29,"missing_person_id_rows":0,"referential_integrity_violations":1,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":3.4483,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"dose_era":{"name":"dose_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"drug_era":{"name":"drug_era","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":972,"missing_person_id_rows":0,"referential_integrity_violations":22,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":2.2634,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":98,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"observation_period":{"name":"observation_period","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":109,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":109,"invalid_concept_rows":0,"default_date_percent":100,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[{"table_name":"observation_period","type_concept":"Standard algorithm from EHR","count":109,"type_group":"EHR"}],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":95,"pass_score":0.2835,"pass_metrics":[{"metric":"source_diversity","score":0.2835,"description":"Evaluates variety of data source types (e.g., EHR, claims, registries)"}],"counts_valid":true,"expected_final":109}},"dqd_score":98,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[{"type_group":"EHR","type_concept":"Standard algorithm from EHR","count":109}],"type_concepts_summary":[{"type_group":"EHR","count":109,"percent":100},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]},"Vocabulary":{"tables":{"concept":{"name":"concept","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_ancestor":{"name":"concept_ancestor","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_class":{"name":"concept_class","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_relationship":{"name":"concept_relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"concept_synonym":{"name":"concept_synonym","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"domain":{"name":"domain","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"drug_strength":{"name":"drug_strength","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":98,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"relationship":{"name":"relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"source_to_concept_map":{"name":"source_to_concept_map","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"vocabulary":{"name":"vocabulary","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0}},"dqd_score":100,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[],"type_concepts_summary":[{"type_group":"EHR","count":0,"percent":0},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]},"Metadata":{"tables":{"cdm_source":{"name":"cdm_source","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":1,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"metadata":{"name":"metadata","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0}},"dqd_score":100,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[],"type_concepts_summary":[{"type_group":"EHR","count":0,"percent":0},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]},"Other":{"tables":{"attribute_definition":{"name":"attribute_definition","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":null,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"cohort":{"name":"cohort","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"cohort_definition":{"name":"cohort_definition","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"episode":{"name":"episode","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"episode_event":{"name":"episode_event","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"fact_relationship":{"name":"fact_relationship","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0},"note_nlp":{"name":"note_nlp","delivered":false,"valid_rows":0,"invalid_rows":0,"initial_rows":0,"final_rows":0,"missing_person_id_rows":0,"referential_integrity_violations":0,"harmonization":0,"transitions_in":0,"rows_out":0,"same_table_result_rows":0,"rows_added_from_mappings":0,"total_harmonization_status_rows":0,"harmonization_percent":0,"default_date_rows":0,"invalid_concept_rows":0,"default_date_percent":0,"invalid_concept_percent":0,"missing_person_id_percent":0,"referential_integrity_percent":0,"invalid_rows_percent":0,"quality_issues":0,"type_concepts":[],"invalid_columns":[],"missing_columns":[],"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"harmonization_statuses":[],"dispositions":[],"same_table_mappings":[],"dqd_score":100,"pass_score":null,"pass_metrics":null,"counts_valid":true,"expected_final":0}},"dqd_score":100,"source_vocabularies":[],"target_vocabularies":[],"transitions":[],"transition_stats":{"total_rows":0,"same_table_count":0,"cross_table_count":0},"type_concepts":[],"type_concepts_summary":[{"type_group":"EHR","count":0,"percent":0},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":0,"percent":0}]}},"overall_transitions":[{"source_table":"procedure_occurrence","target_table":"observation","count":360},{"source_table":"procedure_occurrence","target_table":"procedure_occurrence","count":15151},{"source_table":"procedure_occurrence","target_table":"condition_occurrence","count":163},{"source_table":"measurement","target_table":"measurement","count":62074},{"source_table":"measurement","target_table":"observation","count":1},{"source_table":"procedure_occurrence","target_table":"measurement","count":4},{"source_table":"procedure_occurrence","target_table":"drug_exposure","count":72},{"source_table":"drug_exposure","target_table":"drug_exposure","count":12690}],"overall_transition_stats":{"total_rows":90515,"same_table_count":89915,"cross_table_count":600},"harmonization_statuses":[{"status":"source_concept_id mapped to new target","count":1413},{"status":"existing non-standard target remapped to standard code","count":5}],"total_initial_rows":90624,"overall_type_concepts":[{"type_group":"EHR","type_concept":"EHR","count":71164},{"type_group":"EHR","type_concept":"Standard algorithm from EHR","count":109},{"type_group":"EHR","type_concept":"EHR chief complaint","count":69},{"type_group":"Unlabeled","type_concept":"No matching concept","count":19282}],"overall_type_concepts_summary":[{"type_group":"EHR","count":71342,"percent":78.7231},{"type_group":"Claims","count":0,"percent":0},{"type_group":"Disease registry","count":0,"percent":0},{"type_group":"Patient reported","count":0,"percent":0},{"type_group":"Other","count":0,"percent":0},{"type_group":"Unlabeled","count":19282,"percent":21.2769}],"pass_overall_score":0.7229,"pass_ci_lower":0.6835,"pass_ci_upper":0.7623,"pass_components":[{"metric":"accessibility","description":"Evaluates whether clinical data is present and accessible for analysis","score":0.7814,"standard_error":0.0007,"ci_lower":0.7801,"ci_upper":0.7827,"weight":0.1667,"weighted_contribution":0.1302,"percent_contribution":18.0145},{"metric":"concept_diversity","description":"Quantifies the variety of distinct clinical concepts captured in the data","score":0.5809,"standard_error":0.1058,"ci_lower":0.3735,"ci_upper":0.7883,"weight":0.1667,"weighted_contribution":0.0968,"percent_contribution":13.3928},{"metric":"source_diversity","description":"Evaluates variety of data source types (e.g., EHR, claims, registries)","score":0.3512,"standard_error":0.0428,"ci_lower":0.2672,"ci_upper":0.4351,"weight":0.1667,"weighted_contribution":0.0585,"percent_contribution":8.0963},{"metric":"provenance","description":"Evaluates information preservation and traceability through the mapping process","score":0.9215,"standard_error":0,"ci_lower":0.9214,"ci_upper":0.9215,"weight":0.1667,"weighted_contribution":0.1536,"percent_contribution":21.2441},{"metric":"standards","description":"Measures use of standardized vocabularies required for interoperable research","score":1,"standard_error":0,"ci_lower":1,"ci_upper":1,"weight":0.1667,"weighted_contribution":0.1667,"percent_contribution":23.055},{"metric":"temporal","description":"Assesses data distribution over time including span, density, and consistency","score":0.7025,"standard_error":0.0387,"ci_lower":0.6266,"ci_upper":0.7785,"weight":0.1667,"weighted_contribution":0.1171,"percent_contribution":16.1973},{"metric":"temporal_range","description":"Historical span of data, measured in years","score":0.9857,"standard_error":null,"ci_lower":0.9738,"ci_upper":0.9976,"weight":0,"weighted_contribution":0,"percent_contribution":0},{"metric":"temporal_density","description":"Average volume of clinical records per patient over time","score":0.5692,"standard_error":null,"ci_lower":0.2643,"ci_upper":0.8741,"weight":0,"weighted_contribution":0,"percent_contribution":0},{"metric":"temporal_consistency","description":"Stability of data capture over time, detecting gaps or irregular patterns","score":0.5527,"standard_error":null,"ci_lower":0.4356,"ci_upper":0.6699,"weight":0,"weighted_contribution":0,"percent_contribution":0}],"type_colors":{"EHR":"#0073C2","Claims":"#EFC000","Disease registry":"#A95AA1","Patient reported":"#CD534C","Unlabeled":"#868686","Other":"#7AA6DC"},"table_colors":{"condition_occurrence":"#eab308","device_exposure":"#f87dba","drug_exposure":"#ff8d02","measurement":"#3b82f6","visit_occurrence":"#fa2b2b","observation":"#804ef5","procedure_occurrence":"#84cc16","specimen":"#1c1b1d","note":"#b5b6f5"},"type_group_order":["EHR","Claims","Disease registry","Patient reported","Other","Unlabeled"],"table_order":["person","visit_occurrence","visit_detail","condition_occurrence","drug_exposure","procedure_occurrence","device_exposure","measurement","observation","specimen","note","death"],"tables_without_mismatch_alert":["observation_period","drug_era","condition_era","dose_era","concept","vocabulary","domain","concept_class","concept_relationship","relationship","concept_synonym","concept_ancestor","source_to_concept_map","drug_strength","metadata","cdm_source","note_nlp","fact_relationship","cohort","cohort_definition","episode","episode_event","attribute_definition"],"vocabulary_tables":["concept","vocabulary","domain","concept_class","concept_relationship","relationship","concept_synonym","concept_ancestor","source_to_concept_map","drug_strength"]};
    </script>
    <script>

/* ============================================================================
   OMOP Delivery Report - Interactive JavaScript
   ============================================================================ */

// Global state
let currentGroup = "Clinical Data";
let currentTable = null;
let savedScrollPosition = 0;

// ============================================================================
// UTILITY FUNCTIONS
// ============================================================================

/**
 * Sort table names according to canonical display order from R configuration
 * @param {Array<string>} tables - Array of table names to sort
 * @returns {Array<string>} - Sorted array of table names
 */
function sortTablesByOrder(tables) {
  const tableOrder = REPORT_DATA.table_order || [];

  // Split into tables that are in the order and tables that aren't
  const orderedTables = tables.filter(t => tableOrder.indexOf(t) !== -1);
  const unorderedTables = tables.filter(t => tableOrder.indexOf(t) === -1);

  // Sort ordered tables by their position in table_order
  orderedTables.sort(function(a, b) {
    return tableOrder.indexOf(a) - tableOrder.indexOf(b);
  });

  // Sort unordered tables alphabetically
  unorderedTables.sort(function(a, b) {
    return a.localeCompare(b);
  });

  // Combine
  return orderedTables.concat(unorderedTables);
}

// ============================================================================
// TABLE GROUP SWITCHING
// ============================================================================

function switchTableGroup(groupName) {
  console.log("=== switchTableGroup called ===");
  console.log("Group name:", groupName);

  // Hide all group content
  const allGroups = document.querySelectorAll(".table-group-content");
  console.log("Found", allGroups.length, "group elements");

  allGroups.forEach((group, index) => {
    console.log("  Hiding group " + index + ":", group.id);
    group.style.display = "none";
  });

  // Show selected group
  const groupId = "group-" + groupName.toLowerCase().replace(/ /g, "-");
  console.log("Looking for group ID:", groupId);

  const selectedGroup = document.getElementById(groupId);
  if (selectedGroup) {
    selectedGroup.style.display = "block";
    console.log("Successfully showed group:", groupId);
  } else {
    console.error("Group not found:", groupId);
  }

  currentGroup = groupName;

  // Update type concepts for this group
  updateGroupTypeConcepts(groupName);

  console.log("Current group set to:", currentGroup);
  console.log("=== switchTableGroup complete ===");
}

// ============================================================================
// TABLE SORTING
// ============================================================================

var sortStates = {};

function sortDeliveryTable(groupId, columnIndex, sortType) {
  var tableId = "delivery-table-" + groupId;
  var tbodyId = "delivery-tbody-" + groupId;
  var tbody = document.getElementById(tbodyId);
  var table = document.getElementById(tableId);

  if (!tbody || !table) return;

  // Get current sort state for this table and column
  var stateKey = tableId + "-" + columnIndex;
  var currentSort = sortStates[stateKey] || "none";

  // Toggle sort direction
  var newSort = "asc";
  if (currentSort === "asc") {
    newSort = "desc";
  }

  sortStates[stateKey] = newSort;

  // Remove sort classes from all headers in this table
  var headers = table.querySelectorAll("th.sortable");
  for (var i = 0; i < headers.length; i++) {
    headers[i].classList.remove("sort-asc", "sort-desc");
  }

  // Add sort class to clicked header
  headers[columnIndex > 1 ? columnIndex - 1 : columnIndex].classList.add("sort-" + newSort);

  // Get all rows and convert to array
  var rows = Array.from(tbody.querySelectorAll("tr"));

  // Sort rows
  rows.sort(function(a, b) {
    var aText = a.cells[columnIndex].textContent.trim();
    var bText = b.cells[columnIndex].textContent.trim();

    var aVal, bVal;

    if (sortType === "number") {
      // Handle special case: "--" means N/A, should sort to end
      var aIsNA = aText === "--" || aText === "";
      var bIsNA = bText === "--" || bText === "";

      // If both are N/A, they're equal
      if (aIsNA && bIsNA) return 0;

      // N/A values always sort to the end (regardless of direction)
      if (aIsNA) return 1;  // a goes after b
      if (bIsNA) return -1; // b goes after a

      // Remove commas, plus signs, and parse as number
      aVal = parseFloat(aText.replace(/[,+]/g, ""));
      bVal = parseFloat(bText.replace(/[,+]/g, ""));

      // Handle NaN (shouldn't happen after above checks, but just in case)
      if (isNaN(aVal) && isNaN(bVal)) return 0;
      if (isNaN(aVal)) return 1;
      if (isNaN(bVal)) return -1;
    } else {
      // Text comparison (case insensitive)
      aVal = aText.toLowerCase();
      bVal = bText.toLowerCase();
    }

    if (newSort === "asc") {
      return aVal > bVal ? 1 : aVal < bVal ? -1 : 0;
    } else {
      return aVal < bVal ? 1 : aVal > bVal ? -1 : 0;
    }
  });

  // Re-append sorted rows
  for (var i = 0; i < rows.length; i++) {
    tbody.appendChild(rows[i]);
  }
}

// ============================================================================
// TABLE DRILLDOWN
// ============================================================================

function showTableDrilldown(tableName) {
  currentTable = tableName;

  // Save current scroll position
  savedScrollPosition = window.pageYOffset || document.documentElement.scrollTop;

  // Hide sidebar
  const sidebar = document.querySelector(".sidebar");
  if (sidebar) {
    sidebar.style.display = "none";
  }

  // Hide all other sections
  const sectionsToHide = ["overview", "dqd-grid", "pass-breakdown", "delivery-report", "time-series", "vocab-harmonization", "technical-summary"];
  sectionsToHide.forEach(function(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
      section.style.display = "none";
    }
  });

  // Show drilldown section
  const drilldownSection = document.getElementById("table-drilldown");
  drilldownSection.style.display = "block";

  // Update title with table name
  document.getElementById("drilldown-table-name").textContent = tableName;

  // Get table data from embedded data
  const tableData = getTableData(tableName);

  // Build drilldown content
  const content = buildTableDrilldownContent(tableData);
  document.getElementById("drilldown-content").innerHTML = content;

  // Initialize table drilldown timeline
  initializeTableDrilldownTimeSeries(tableName);

  // Scroll to top of page
  window.scrollTo(0, 0);

  // Add history state so browser back button works
  history.pushState({ view: "drilldown", table: tableName }, "", "#" + tableName);

  console.log("Showing drilldown for table:", tableName);
}

function hideTableDrilldown() {
  // Show sidebar
  const sidebar = document.querySelector(".sidebar");
  if (sidebar) {
    sidebar.style.display = "block";
  }

  // Show all other sections
  const sectionsToShow = ["overview", "dqd-grid", "pass-breakdown", "delivery-report", "time-series", "vocab-harmonization", "technical-summary"];
  sectionsToShow.forEach(function(sectionId) {
    const section = document.getElementById(sectionId);
    if (section) {
      section.style.display = "block";
    }
  });

  // Hide drilldown section
  document.getElementById("table-drilldown").style.display = "none";

  currentTable = null;

  // Restore scroll position after DOM has re-rendered
  // Use setTimeout to ensure the browser has finished updating the layout
  setTimeout(function() {
    window.scrollTo(0, savedScrollPosition);
  }, 0);

  // Update URL to remove table anchor
  if (window.location.hash) {
    history.pushState({ view: "main" }, "", window.location.pathname);
  }

  console.log("Hiding table drilldown");
}

// ============================================================================
// DATA RETRIEVAL HELPERS
// ============================================================================

function getTableData(tableName) {
  // Find table in any group
  for (const groupName in REPORT_DATA.groups) {
    const group = REPORT_DATA.groups[groupName];
    if (group.tables && group.tables[tableName]) {
      return group.tables[tableName];
    }
  }
  return null;
}

function getGroupData(groupName) {
  return REPORT_DATA.groups[groupName] || null;
}

// ============================================================================
// TABLE DRILLDOWN CONTENT BUILDER
// ============================================================================

function buildTableDrilldownContent(tableData) {
  if (!tableData) {
    return "<p>No data available for this table.</p>";
  }

  let html = "";

  // Get pre-computed quality metrics from R
  var defaultDateRows = tableData.default_date_rows || 0;
  var defaultDatePercent = (tableData.default_date_percent || 0).toFixed(1);
  var invalidConceptRows = tableData.invalid_concept_rows || 0;
  var invalidConceptPercent = (tableData.invalid_concept_percent || 0).toFixed(1);

  // Build consolidated Data Quality Alerts section
  var qualityWarnings = [];

  // Get tables that should not show certain alerts from configuration
  var tablesWithoutMismatchAlert = REPORT_DATA.tables_without_mismatch_alert || [];
  var shouldShowMismatchAlert = tablesWithoutMismatchAlert.indexOf(tableData.name) === -1;

  // Get vocabulary tables from R configuration (skip default date warnings)
  var vocabularyTables = REPORT_DATA.vocabulary_tables || [];
  var isVocabularyTable = vocabularyTables.indexOf(tableData.name) !== -1;

  // Count validation warning - skip for derived data, vocabulary, metadata, and other tables
  if (tableData.counts_valid === false && shouldShowMismatchAlert) {
    qualityWarnings.push(`🧮 <strong>Row count mismatch:</strong> Expected final rows: ` + formatNumber(tableData.expected_final_rows) + `, Actual: ` + formatNumber(tableData.final_rows) + `. Please review the pipeline output.`);
  }

  // Default dates warning (>1%) - skip for vocabulary tables
  if (parseFloat(defaultDatePercent) > 1 && tableData.final_rows > 0 && !isVocabularyTable) {
    qualityWarnings.push(`📅 <strong>` + defaultDatePercent + `%</strong> of rows have default/placeholder dates`);
  }

  // Invalid concepts warning (>0)
  if (invalidConceptRows > 0 && tableData.final_rows > 0) {
    var rowWord = invalidConceptRows === 1 ? "row has" : "rows have";
    qualityWarnings.push(`📖 <strong>` + formatNumber(invalidConceptRows) + `</strong> ` + rowWord + ` invalid concept IDs`);
  }

  // Invalid rows warning (>0)
  if (tableData.invalid_rows > 0 && tableData.final_rows > 0) {
    var invalidRowWord = tableData.invalid_rows === 1 ? "row does" : "rows do";
    var invalidRemovedWord = tableData.invalid_rows === 1 ? "was removed" : "were removed";
    qualityWarnings.push(`🧩 <strong>` + formatNumber(tableData.invalid_rows) + `</strong> ` + invalidRowWord + ` not meet OMOP data type specifications and ` + invalidRemovedWord);
  }

  // Missing Connect ID warning (>0)
  if (tableData.missing_person_id_rows > 0 && tableData.final_rows > 0) {
    var missingRowWord = tableData.missing_person_id_rows === 1 ? "row does" : "rows do";
    var missingRemovedWord = tableData.missing_person_id_rows === 1 ? "was removed" : "were removed";
    qualityWarnings.push(`👤 <strong>` + formatNumber(tableData.missing_person_id_rows) + `</strong> ` + missingRowWord + ` not have a Connect ID value and ` + missingRemovedWord);
  }

  // Referential integrity violations warning (>0)
  if (tableData.referential_integrity_violations > 0 && tableData.final_rows > 0) {
    var violationWord = tableData.referential_integrity_violations === 1 ? "row has a person_id" : "rows have person_ids";
    qualityWarnings.push(`🧑‍🧒 <strong>` + formatNumber(tableData.referential_integrity_violations) + `</strong> ` + violationWord + ` that do not exist in the person table`);
  }

  // Display warnings if any exist
  if (qualityWarnings.length > 0) {
    html += `
      <div class="info-box drilldown-alert-box">
        <h5 class="drilldown-alert-title">Data Quality Alerts</h5>
    `;
    qualityWarnings.forEach(function(warning) {
      html += `<p class="drilldown-alert-text">` + warning + `</p>`;
    });
    html += `
      </div>
    `;
  }

  // Create consistent column-to-color mapping for vocabulary tables
  var columnColorMap = {};
  var allColumns = [];
  var colors = ["#ffffff", "#f8fafc"];

  // Collect all unique column names from both source and target vocabularies
  if (tableData.source_vocabularies) {
    tableData.source_vocabularies.forEach(function(v) {
      if (allColumns.indexOf(v.column_name) === -1) {
        allColumns.push(v.column_name);
      }
    });
  }
  if (tableData.target_vocabularies) {
    tableData.target_vocabularies.forEach(function(v) {
      if (allColumns.indexOf(v.column_name) === -1) {
        allColumns.push(v.column_name);
      }
    });
  }

  // Sort columns alphabetically and assign alternating colors
  allColumns.sort();
  allColumns.forEach(function(col, index) {
    columnColorMap[col] = colors[index % 2];
  });

  // Overview Metrics
  var dqdClass = tableData.final_rows === 0 ? "neutral" : getDQDClass(tableData.dqd_score);
  var dqdDisplay = tableData.final_rows === 0 ? "N/A" : (tableData.dqd_score !== null && tableData.dqd_score !== undefined ? tableData.dqd_score + "%" : "N/A");

  var passClass = tableData.final_rows === 0 ? "neutral" : getPASSClass(tableData.pass_score);
  var passDisplay = tableData.final_rows === 0 ? "N/A" : (tableData.pass_score !== null && tableData.pass_score !== undefined ? tableData.pass_score.toFixed(2) : "N/A");

  html += `
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="metric-label">DQD Score</div>
        <div class="text-center mt-20">
          <div class="dqd-score drilldown-dqd-score ` + dqdClass + `">
            ` + dqdDisplay + `
          </div>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-label">PASS</div>
        <div class="text-center mt-20">
          <div class="pass-score drilldown-pass-score ` + passClass + `">
            ` + passDisplay + `
          </div>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-label">Initial Rows</div>
        <div class="metric-value">` + formatNumber(tableData.initial_rows) + `</div>
        <div class="metric-sublabel">Total before processing</div>
      </div>

      <div class="metric-card">
        <div class="metric-label">Final Rows</div>
        <div class="metric-value">` + formatNumber(tableData.final_rows) + `</div>
        <div class="metric-sublabel">After all processing</div>
      </div>
    </div>
  `;

  // Data Quality Control Section - Always show, highlight issues
  html += `<div class="subsection"><h4>Data Quality Control</h4>`;

  // Cards container for 5 cards in 3-2 layout
  // Top row: 3 cards (Rows Without Connect ID, Referential Integrity, Invalid Rows)
  // Bottom row: 2 cards (Invalid Concepts, Default Dates)
  html += `<div class="quality-cards-grid">`;

  // Row 1: Rows Without Connect ID | Referential Integrity Violations | Invalid Rows
  // Rows Without Connect ID Card
  var missingClass = tableData.final_rows === 0 ? "neutral" : (tableData.missing_person_id_rows > 0 ? "warning" : "success");
  var missingPercent = (tableData.missing_person_id_percent || 0).toFixed(1);
  var missingDisplay = tableData.final_rows === 0 ? "N/A" : (formatNumber(tableData.missing_person_id_rows) + ` <span class="percentage-display">(` + missingPercent + `%)</span>`);
  html += `
    <div class="metric-card ` + missingClass + `">
      <div class="metric-label">Rows Without Connect ID</div>
      <div class="metric-value">` + missingDisplay + `</div>
      <div class="metric-sublabel">Missing person_id, removed from delivery</div>
    </div>
  `;

  // Referential Integrity Violations Card
  var refIntegrityViolations = tableData.referential_integrity_violations || 0;
  var refIntegrityClass = tableData.final_rows === 0 ? "neutral" : (refIntegrityViolations > 0 ? "warning" : "success");
  var refIntegrityPercent = (tableData.referential_integrity_percent || 0).toFixed(1);
  var refIntegrityDisplay = tableData.final_rows === 0 ? "N/A" : (formatNumber(refIntegrityViolations) + ` <span class="percentage-display">(` + refIntegrityPercent + `%)</span>`);
  html += `
    <div class="metric-card ` + refIntegrityClass + `">
      <div class="metric-label">Referential Integrity Violations</div>
      <div class="metric-value">` + refIntegrityDisplay + `</div>
      <div class="metric-sublabel">Rows with person_id not in person table</div>
    </div>
  `;

  // Invalid Rows Card
  var invalidClass = tableData.final_rows === 0 ? "neutral" : (tableData.invalid_rows > 0 ? "warning" : "success");
  var invalidPercent = (tableData.invalid_rows_percent || 0).toFixed(1);
  var invalidDisplay = tableData.final_rows === 0 ? "N/A" : (formatNumber(tableData.invalid_rows) + ` <span class="percentage-display">(` + invalidPercent + `%)</span>`);
  html += `
    <div class="metric-card ` + invalidClass + `">
      <div class="metric-label">Invalid Rows</div>
      <div class="metric-value">` + invalidDisplay + `</div>
      <div class="metric-sublabel">Did not meet OMOP data type specs</div>
    </div>
  `;

  // Row 2: Rows with Invalid Concepts | Rows with Default Dates
  // Invalid Concepts Card (variables already declared at top for warnings)
  var invalidConceptClass = tableData.final_rows === 0 ? "neutral" : (invalidConceptRows > 0 ? "warning" : "success");
  var invalidConceptDisplay = tableData.final_rows === 0 ? "N/A" : (formatNumber(invalidConceptRows) + ` <span class="percentage-display">(` + invalidConceptPercent + `%)</span>`);
  html += `
    <div class="metric-card ` + invalidConceptClass + `">
      <div class="metric-label">Rows with Invalid Concepts</div>
      <div class="metric-value">` + invalidConceptDisplay + `</div>
      <div class="metric-sublabel">Concept IDs not in vocabulary tables</div>
    </div>
  `;

  // Default Date Values Card (variables already declared at top for warnings)
  // Determine color based on percentage: 0-1% green, >1-15% yellow, >15% red
  var defaultDateClass = "success";
  if (tableData.final_rows === 0) {
    defaultDateClass = "neutral";
  } else if (parseFloat(defaultDatePercent) > 15) {
    defaultDateClass = "warning";  // Use warning for >15% (will show red-ish)
  } else if (parseFloat(defaultDatePercent) > 1) {
    defaultDateClass = "warning";
  }

  var defaultDateDisplay = tableData.final_rows === 0 ? "N/A" : (formatNumber(defaultDateRows) + ` <span class="percentage-display">(` + defaultDatePercent + `%)</span>`);

  html += `
    <div class="metric-card ` + defaultDateClass + `">
      <div class="metric-label">Rows with Default Dates</div>
      <div class="metric-value">` + defaultDateDisplay + `</div>
      <div class="metric-sublabel">Placeholder date values (e.g., 1900-01-01)</div>
    </div>
  `;

  html += `</div>`;  // End cards grid

  // Extra Columns Removed - Always show for delivered tables
  if (tableData.delivered) {
    html += `
      <div class="drilldown-section-spacing">
        <h5 style="margin: 0 0 10px 0;">Extra Columns Removed</h5>
        <div class="info-box">
    `;

    if (tableData.invalid_columns && tableData.invalid_columns.length > 0) {
      var columnCount = tableData.invalid_columns.length;
      var columnWord = columnCount === 1 ? "column was" : "columns were";
      html += `
          <p><strong>` + columnCount + `</strong> non-OMOP ` + columnWord + ` removed:</p>
          <p style="font-family: monospace; color: #666;">` + tableData.invalid_columns.join(", ") + `</p>
      `;
    } else {
      html += `
          <p>No extra columns were removed.</p>
      `;
    }

    html += `
        </div>
      </div>
    `;
  }

  // Missing Columns Added - Always show for delivered tables
  if (tableData.delivered) {
    html += `
      <div class="drilldown-section-spacing">
        <h5 style="margin: 0 0 10px 0;">Missing Columns Added</h5>
        <div class="info-box">
    `;

    if (tableData.missing_columns && (typeof tableData.missing_columns === "string" || tableData.missing_columns.length > 0)) {
      // Handle both string (single column) and array (multiple columns) cases
      var missingColumnsArray = typeof tableData.missing_columns === "string" ? [tableData.missing_columns] : tableData.missing_columns;
      var missingColumnCount = missingColumnsArray.length;
      var missingColumnWord = missingColumnCount === 1 ? "column was" : "columns were";
      html += `
          <p><strong>` + missingColumnCount + `</strong> OMOP ` + missingColumnWord + ` added:</p>
          <p style="font-family: monospace; color: #666;">` + missingColumnsArray.join(", ") + `</p>
      `;
    } else {
      html += `
          <p>All required OMOP columns were present.</p>
      `;
    }

    html += `
        </div>
      </div>
    `;
  }

  html += `</div>`;  // End Data Quality Control subsection

  // PASS Breakdown Section (table-specific)
  if (tableData.pass_metrics && tableData.pass_metrics.length > 0) {
    html += `
      <div class="subsection">
        <h4 style="margin-bottom: 16px;">Composite Score Breakdown</h4>
        <table class="pass-components-table">
          <thead>
            <tr>
              <th>Metric</th>
              <th>Score</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
    `;

    // Use metrics in the order provided by R (preserves temporal sub-metrics placement)
    tableData.pass_metrics.forEach(function(metric) {
      var scoreFormatted = metric.score.toFixed(2);

      // Table-level metrics don't have standard errors, so no uncertainty range or tooltip
      var visualization = buildPASSScoreVisualization(metric.score, null, null, 140, 32);

      // Check if this is a temporal sub-metric
      var isTemporalSub = metric.metric.startsWith('temporal_');

      // Format metric name for display
      var metricDisplayName = metric.metric;
      if (isTemporalSub) {
        // Extract sub-metric name (e.g., "temporal_range" -> "Range")
        var subMetricName = metric.metric.replace('temporal_', '');
        metricDisplayName = subMetricName.charAt(0).toUpperCase() + subMetricName.slice(1);
      } else {
        // Format main metric names with proper capitalization
        if (metric.metric === 'concept_diversity') {
          metricDisplayName = 'Concept Diversity';
        } else if (metric.metric === 'source_diversity') {
          metricDisplayName = 'Source Diversity';
        } else {
          // Capitalize first letter for other metrics
          metricDisplayName = metric.metric.charAt(0).toUpperCase() + metric.metric.slice(1);
        }
      }

      // Apply indentation and special styling for temporal sub-metrics
      var rowClass = isTemporalSub ? 'pass-sub-metric-row' : '';
      var namePrefix = isTemporalSub ? '<span style="color: #94a3b8; margin-right: 6px;">↳</span>' : '';
      var nameStyle = isTemporalSub ? 'color: #64748b; font-size: 0.95em;' : '';

      html += `
            <tr class="` + rowClass + `">
              <td class="pass-metric-name" style="` + nameStyle + `">` + namePrefix + metricDisplayName + `</td>
              <td class="pass-score-cell" style="padding: 8px 12px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                  <span style="font-weight: 600; min-width: 40px;">` + scoreFormatted + `</span>
                  ` + visualization + `
                </div>
              </td>
              <td class="pass-description-cell">` + metric.description + `</td>
            </tr>
      `;
    });

    html += `
          </tbody>
        </table>
      </div>
    `;
  }

  // Type Concepts
  if (tableData.type_concepts && tableData.type_concepts.length > 0) {
    html += `
      <div class="subsection">
        <h4 style="margin-bottom: 4px;">Type Concept Breakdown</h4>
        <div style="font-size: 0.9em; color: #94a3b8; margin-bottom: 8px; text-align: left;">${tableData.name}</div>
        <div class="chart-container" style="margin-top: 16px;">
          ${buildTypeConceptChart(tableData.type_concepts)}
        </div>
      </div>
    `;
  }

  // Data Timeline Section
  html += `
    <div class="subsection">
      <h4 style="margin-bottom: 4px;">Data Timeline</h4>
      <div style="font-size: 0.9em; color: #94a3b8; margin-bottom: 8px; text-align: center;">${tableData.name}</div>

      <div style="margin-top: 16px;">
        <div class="toggle-buttons drilldown-time-series-controls">
          <button class="toggle-button active" id="drilldown-time-series-recent" data-action="switch-drilldown-time-series-view" data-view="recent">Last 15 Years</button>
          <button class="toggle-button" id="drilldown-time-series-custom" data-action="switch-drilldown-time-series-view" data-view="custom">Custom</button>
        </div>

        <div id="drilldown-time-series-custom-controls" class="drilldown-time-series-custom-controls" style="display: none;">
          <label class="drilldown-time-series-label">From:</label>
          <input type="number" id="drilldown-time-series-start-year" min="1900" max="2100" placeholder="YYYY" class="drilldown-time-series-input">
          <label class="drilldown-time-series-label">To:</label>
          <input type="number" id="drilldown-time-series-end-year" min="1900" max="2100" placeholder="YYYY" class="drilldown-time-series-input">
          <button data-action="apply-drilldown-year-range" class="drilldown-time-series-button">Apply</button>
        </div>

        <div id="table-drilldown-time-series-chart-container" class="drilldown-time-series-chart">
          <!-- Chart will be populated by JavaScript -->
        </div>
      </div>
    </div>
  `;

  // Use pre-computed harmonization data from R
  var rowsIn = tableData.transitions_in || 0;
  var rowsOut = tableData.rows_out || 0;
  var harmonizationNet = tableData.harmonization || 0;

  // Use pre-calculated rows added from mappings (calculated in R)
  var rowsAddedFromMappings = tableData.rows_added_from_mappings || 0;

  // Only show harmonization flow if there was actual harmonization activity
  if (harmonizationNet !== 0) {
    // Format rows out (red with minus sign if > 0)
    var rowsOutFormatted = rowsOut > 0 ? '<span style="color: #ef4444;">-' + formatNumber(rowsOut) + '</span>' : formatNumber(rowsOut);

    // Format rows in (green with plus sign if > 0)
    var rowsInFormatted = rowsIn > 0 ? '<span style="color: #10b981;">+' + formatNumber(rowsIn) + '</span>' : formatNumber(rowsIn);

    // Format rows added from mappings (green with plus sign if > 0)
    var rowsAddedFormatted = rowsAddedFromMappings > 0 ? '<span style="color: #10b981;">+' + formatNumber(rowsAddedFromMappings) + '</span>' : formatNumber(rowsAddedFromMappings);

    html += `
      <div class="subsection">
        <h4>Vocabulary Harmonization Flow</h4>
        <div class="info-box">
          <ul style="margin: 0; padding-left: 20px;">
            <li>Rows moved to other tables: ` + rowsOutFormatted + `</li>
            <li>Rows received from other tables: ` + rowsInFormatted + `</li>
            <li>Rows added from 1:N mappings: ` + rowsAddedFormatted + `</li>
          </ul>
    `;

    var netClass = harmonizationNet > 0 ? "harmonization-positive" : (harmonizationNet < 0 ? "harmonization-negative" : "harmonization-neutral");
    var netSign = harmonizationNet > 0 ? "+" : "";

    html += `
          <p style="margin-top: 15px; margin-bottom: 0;"><strong>Net Impact:</strong> <span class="` + netClass + `">` + netSign + formatNumber(harmonizationNet) + ` rows</span></p>
        </div>
      </div>
    `;
  }


  // Transitions and Harmonization
  if (tableData.transitions && tableData.transitions.length > 0) {
    html += `
      <div class="subsection">
        <h4>Vocabulary Harmonization & Table Transitions</h4>
    `;

    // Harmonization Strategies (if available)
    if (tableData.harmonization_statuses && tableData.harmonization_statuses.length > 0) {
      // Use pre-calculated values from R
      const totalStatusRows = tableData.total_harmonization_status_rows || 0;
      const tableInitialRows = tableData.initial_rows || 0;
      const tableHarmonizationPercent = tableData.harmonization_percent || 0;

      html += `
        <div class="info-box" style="margin-bottom: 20px;">
          <h5 style="margin-top: 0; margin-bottom: 15px;">Harmonization Strategies</h5>
          <p style="margin-bottom: 15px;">Breakdown of vocabulary harmonization approaches applied to <strong>${tableData.name}</strong>:</p>
          <div style="display: grid; grid-template-columns: 3fr 1fr; gap: 10px; align-items: center; margin-bottom: 10px;">
            <div style="font-weight: 600;">Strategy</div>
            <div style="font-weight: 600; text-align: right;">Count</div>
      `;

      tableData.harmonization_statuses.forEach(function(status) {
        html += `
            <div style="padding: 8px 0; border-top: 1px solid #e5e7eb;">${status.status}</div>
            <div style="padding: 8px 0; border-top: 1px solid #e5e7eb; text-align: right;">${formatNumber(status.count)}</div>
        `;
      });

      html += `
          </div>
          <p style="margin-top: 15px; margin-bottom: 0;"><strong>Total Records Harmonized:</strong> ${formatNumber(totalStatusRows)} out of ${formatNumber(tableInitialRows)} (${tableHarmonizationPercent}% of table's initial rows)</p>
        </div>
      `;
    }

    // Sankey Diagram
    html += `
        <h5 style="margin-top: 30px; margin-bottom: 16px;">Table Transition Flow</h5>
        ${buildSankeyDiagram(tableData.transitions)}
      </div>
    `;
  }

  // Vocabulary Breakdown - Side-by-Side Source and Target Sections (moved to bottom)
  if ((tableData.source_vocabularies && tableData.source_vocabularies.length > 0) ||
      (tableData.target_vocabularies && tableData.target_vocabularies.length > 0)) {
    html += `<div class="subsection"><h4>Vocabulary Breakdown</h4>`;

    html += `<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-top: 24px;">`;

    // Source Vocabularies Section
    if (tableData.source_vocabularies && tableData.source_vocabularies.length > 0) {
      // Sort by column_name first, then by count DESC within each column
      var sortedSourceVocab = tableData.source_vocabularies.sort(function(a, b) {
        if (a.column_name < b.column_name) return -1;
        if (a.column_name > b.column_name) return 1;
        return b.count - a.count;
      });

      // Build rows using consistent column color mapping
      var sourceVocabRows = "";
      sortedSourceVocab.forEach(function(v) {
        var bgColor = columnColorMap[v.column_name] || "#ffffff";
        sourceVocabRows += `
                  <tr style="background-color: ${bgColor};">
                    <td>${v.column_name}</td>
                    <td><strong>${v.vocabulary}</strong></td>
                    <td style="text-align: right;">${formatNumber(v.count)}</td>
                  </tr>`;
      });

      html += `
          <div>
            <h5 style="margin-bottom: 16px; font-size: 1em; color: #475569;">Source Vocabularies</h5>
            <div class="table-container" style="border: 2px solid #e2e8f0; border-radius: 8px;">
              <table class="vocab-table">
                <thead style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);">
                  <tr>
                    <th>Column</th>
                    <th>Vocabulary</th>
                    <th style="text-align: right;">Count</th>
                  </tr>
                </thead>
                <tbody>${sourceVocabRows}
                </tbody>
              </table>
            </div>
          </div>
      `;
    } else {
      html += `<div></div>`; // Empty div for grid spacing
    }

    // Target Vocabularies Section
    if (tableData.target_vocabularies && tableData.target_vocabularies.length > 0) {
      // Sort by column_name first, then by count DESC within each column
      var sortedTargetVocab = tableData.target_vocabularies.sort(function(a, b) {
        if (a.column_name < b.column_name) return -1;
        if (a.column_name > b.column_name) return 1;
        return b.count - a.count;
      });

      // Build rows using consistent column color mapping
      var targetVocabRows = "";
      sortedTargetVocab.forEach(function(v) {
        var bgColor = columnColorMap[v.column_name] || "#ffffff";
        targetVocabRows += `
                  <tr style="background-color: ${bgColor};">
                    <td>${v.column_name}</td>
                    <td><strong>${v.vocabulary}</strong></td>
                    <td style="text-align: right;">${formatNumber(v.count)}</td>
                  </tr>`;
      });

      html += `
          <div>
            <h5 style="margin-bottom: 16px; font-size: 1em; color: #475569;">Target Vocabularies</h5>
            <div class="table-container" style="border: 2px solid #e2e8f0; border-radius: 8px;">
              <table class="vocab-table">
                <thead style="background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);">
                  <tr>
                    <th>Column</th>
                    <th>Vocabulary</th>
                    <th style="text-align: right;">Count</th>
                  </tr>
                </thead>
                <tbody>${targetVocabRows}
                </tbody>
              </table>
            </div>
          </div>
      `;
    } else {
      html += `<div></div>`; // Empty div for grid spacing
    }

    html += `</div></div>`; // Close grid and subsection
  }

  return html;
}

// ============================================================================
// GROUP TYPE CONCEPT UPDATES
// ============================================================================

function updateGroupTypeConcepts(groupName) {
  console.log("==== updateGroupTypeConcepts ====");
  console.log("Group name:", groupName);

  const groupData = getGroupData(groupName);
  console.log("Group data:", groupData);
  console.log("Has type_concepts:", groupData && groupData.type_concepts);
  console.log("Type concepts length:", groupData && groupData.type_concepts && groupData.type_concepts.length);

  if (!groupData || !groupData.type_concepts || groupData.type_concepts.length === 0) {
    const groupId = groupName.toLowerCase().replace(/ /g, "-");
    console.log("No type concepts, looking for container:", "group-type-concepts-" + groupId);
    const container = document.getElementById("group-type-concepts-" + groupId);
    console.log("Container found:", container !== null);
    if (container) {
      container.innerHTML = "<p>No type concept data available for this group</p>";
    }
    return;
  }

  const groupId = groupName.toLowerCase().replace(/ /g, "-");
  console.log("Looking for container:", "group-type-concepts-" + groupId);
  const container = document.getElementById("group-type-concepts-" + groupId);
  console.log("Container found:", container !== null);

  if (container) {
    const html = buildTypeConceptChart(groupData.type_concepts);
    container.innerHTML = html;
    console.log("Type concepts updated successfully");
  } else {
    console.warn("Container not found for group ID:", groupId);
  }
}

// ============================================================================
// VOCABULARY HARMONIZATION
// ============================================================================

function initializeVocabHarmonization() {
  console.log("==== initializeVocabHarmonization ====");

  const container = document.getElementById("vocab-harm-content");
  if (!container) {
    console.warn("Vocabulary harmonization container not found");
    return;
  }

  const transitions = REPORT_DATA.overall_transitions;
  console.log("Overall transitions:", transitions);
  console.log("Transitions length:", transitions ? transitions.length : 0);

  if (!transitions || transitions.length === 0) {
    container.innerHTML = "<p>No vocabulary harmonization data available</p>";
    return;
  }

  const html = buildVocabHarmonizationContent(transitions);
  container.innerHTML = html;
  console.log("Vocabulary harmonization initialized successfully");
}

function buildVocabHarmonizationContent(transitions) {
  let html = "";

  // Build harmonization strategies breakdown
  const harmonizationStatuses = REPORT_DATA.harmonization_statuses;
  if (harmonizationStatuses && harmonizationStatuses.length > 0) {
    const totalStatusRows = harmonizationStatuses.reduce(function(sum, s) { return sum + s.count; }, 0);

    html += "<h5 style=\"margin-top: 0;\">Harmonization Strategies</h5>";
    html += "<div class=\"info-box\" style=\"margin-bottom: 20px;\">";
    html += "<p style=\"margin-bottom: 15px;\">Breakdown of vocabulary harmonization approaches applied during processing:</p>";
    html += "<div style=\"display: grid; grid-template-columns: 3fr 1fr; gap: 10px; align-items: center; margin-bottom: 10px;\">";
    html += "<div style=\"font-weight: 600;\">Strategy</div>";
    html += "<div style=\"font-weight: 600; text-align: right;\">Count</div>";

    harmonizationStatuses.forEach(function(status) {
      html += "<div style=\"padding: 8px 0; border-top: 1px solid #e5e7eb;\">" + status.status + "</div>";
      html += "<div style=\"padding: 8px 0; border-top: 1px solid #e5e7eb; text-align: right;\">" + formatNumber(status.count) + "</div>";
    });

    html += "</div>";

    // Calculate harmonization impact as percentage of all delivered rows
    const totalInitial = REPORT_DATA.total_initial_rows || 0;
    const harmonizationPercent = totalInitial > 0 ? Math.round((totalStatusRows / totalInitial) * 100) : 0;

    html += "<p style=\"margin-top: 15px; margin-bottom: 0;\"><strong>Total Records Harmonized:</strong> " +
            formatNumber(totalStatusRows) + " out of " + formatNumber(totalInitial) +
            " (" + harmonizationPercent + "% of all delivered rows across all tables)</p>";
    html += "</div>";
  }

  // Use pre-computed transition statistics from R
  const transitionStats = REPORT_DATA.overall_transition_stats;
  const totalRows = transitionStats.total_rows || 0;
  const sameTableCount = transitionStats.same_table_count || 0;
  const crossTableCount = transitionStats.cross_table_count || 0;

  // Calculate percentages for display
  const sameTablePercent = totalRows > 0 ? Math.round((sameTableCount / totalRows) * 100) : 0;
  const crossTablePercent = totalRows > 0 ? Math.round((crossTableCount / totalRows) * 100) : 0;

  // Build Table Transition Flow section
  html += "<h5 style=\"margin-top: 30px;\">Table Transition Flow</h5>";
  html += "<div class=\"info-box\" style=\"margin-bottom: 20px;\">";
  html += "<p style=\"margin-bottom: 10px; color: #6b7280; font-size: 0.95em;\">Clinical data rows that went through vocabulary harmonization (excludes vocabulary reference and metadata tables)</p>";
  html += "<p><strong>Total Rows Processed:</strong> " + formatNumber(totalRows) + "</p>";
  html += "<p><strong>Rows Staying in Same Table:</strong> " + formatNumber(sameTableCount) + " (" + sameTablePercent + "%)</p>";
  html += "<p style=\"margin-bottom: 0;\"><strong>Rows Moving Between Tables:</strong> " + formatNumber(crossTableCount) + " (" + crossTablePercent + "%)</p>";
  html += "</div>";

  html += buildSankeyDiagram(transitions);

  return html;
}

function buildSankeyDiagram(transitions) {
  if (!transitions || transitions.length === 0) {
    return "<p>No transitions to display</p>";
  }

  // Use table colors from configuration
  const tableColors = REPORT_DATA.table_colors || {};

  // Get unique source and target tables
  const sourceSet = new Set();
  const targetSet = new Set();
  transitions.forEach(function(t) {
    sourceSet.add(t.source_table);
    targetSet.add(t.target_table);
  });

  // Sort using canonical table order from R configuration
  const sources = sortTablesByOrder(Array.from(sourceSet));
  const targets = sortTablesByOrder(Array.from(targetSet));

  // Calculate node values based on total flow
  const sourceFlows = {};
  const targetFlows = {};

  sources.forEach(function(s) { sourceFlows[s] = 0; });
  targets.forEach(function(t) { targetFlows[t] = 0; });

  transitions.forEach(function(t) {
    sourceFlows[t.source_table] += t.count;
    targetFlows[t.target_table] += t.count;
  });

  // Find max flow for scaling
  const maxFlow = Math.max(
    Math.max.apply(Math, Object.values(sourceFlows)),
    Math.max.apply(Math, Object.values(targetFlows))
  );

  // SVG dimensions and layout
  const width = 900;
  const nodeWidth = 20;
  const minNodeSpacing = 35; // Minimum space between nodes
  const maxNodeHeight = 50;
  const minNodeHeight = 12;
  const leftX = 180;
  const rightX = width - 180;

  // Calculate node positions and heights first to determine actual height needed
  const sourceNodes = {};
  const targetNodes = {};

  let sourceY = 50;
  sources.forEach(function(source) {
    const flowRatio = sourceFlows[source] / maxFlow;
    const nodeHeight = minNodeHeight + (flowRatio * (maxNodeHeight - minNodeHeight));
    sourceNodes[source] = {
      x: leftX,
      y: sourceY,
      height: nodeHeight,
      value: sourceFlows[source]
    };
    sourceY += nodeHeight + minNodeSpacing; // Use node height + spacing
  });

  let targetY = 50;
  targets.forEach(function(target) {
    const flowRatio = targetFlows[target] / maxFlow;
    const nodeHeight = minNodeHeight + (flowRatio * (maxNodeHeight - minNodeHeight));
    targetNodes[target] = {
      x: rightX,
      y: targetY,
      height: nodeHeight,
      value: targetFlows[target]
    };
    targetY += nodeHeight + minNodeSpacing; // Use node height + spacing
  });

  // Calculate actual height needed based on the tallest column
  const height = Math.max(sourceY, targetY) + 10;

  // Sort transitions by count for rendering
  const sortedTransitions = transitions.slice().sort(function(a, b) { return b.count - a.count; });

  // Build SVG
  let html = "<div class=\"sankey-diagram\" style=\"padding: 15px 20px; background: #f8fafc; border: 1px solid #e2e8f0; overflow-x: auto;\">";
  html += "<svg width=\"" + width + "\" height=\"" + height + "\" style=\"font-family: system-ui, -apple-system, sans-serif; display: block;\">";

  // Track vertical offsets for stacking flows from each node
  const sourceOffsets = {};
  const targetOffsets = {};
  sources.forEach(function(s) { sourceOffsets[s] = 0; });
  targets.forEach(function(t) { targetOffsets[t] = 0; });

  // Draw flows (links) - draw them first so they appear behind nodes
  sortedTransitions.forEach(function(transition) {
    const source = transition.source_table;
    const target = transition.target_table;
    const value = transition.count;

    const sourceNode = sourceNodes[source];
    const targetNode = targetNodes[target];

    if (!sourceNode || !targetNode) return;

    // Calculate link height proportional to value
    const flowRatio = value / sourceFlows[source];
    const linkHeight = flowRatio * sourceNode.height;

    // Calculate start and end positions
    const x1 = sourceNode.x + nodeWidth;
    const y1 = sourceNode.y + sourceOffsets[source] + (linkHeight / 2);
    const x2 = targetNode.x;
    const y2 = targetNode.y + targetOffsets[target] + (linkHeight / 2);

    // Update offsets for next link
    sourceOffsets[source] += linkHeight;
    targetOffsets[target] += (value / targetFlows[target]) * targetNode.height;

    // Create curved path using cubic Bezier
    const controlPointX = (x1 + x2) / 2;
    const path = "M" + x1 + "," + y1 +
                 " C" + controlPointX + "," + y1 +
                 " " + controlPointX + "," + y2 +
                 " " + x2 + "," + y2;

    // Use source table color for the flow
    const color = tableColors[source] || "#64748b";
    const opacity = 0.5;

    html += "<path d=\"" + path + "\" stroke=\"" + color + "\" stroke-width=\"" + Math.max(1, linkHeight) + "\" fill=\"none\" opacity=\"" + opacity + "\" style=\"cursor: pointer;\">";
    html += "<title>" + source + " → " + target + ": " + formatNumber(value) + " records</title>";
    html += "</path>";
  });

  // Draw source nodes
  sources.forEach(function(source) {
    const node = sourceNodes[source];
    const nodeColor = tableColors[source] || "#0f172a";
    html += "<rect x=\"" + node.x + "\" y=\"" + node.y + "\" width=\"" + nodeWidth + "\" height=\"" + node.height + "\" fill=\"" + nodeColor + "\" rx=\"2\"/>";
    html += "<text x=\"" + (node.x - 10) + "\" y=\"" + (node.y + node.height / 2) + "\" text-anchor=\"end\" dominant-baseline=\"middle\" font-size=\"13\" font-weight=\"500\" fill=\"#1e293b\">" + source + "</text>";
    html += "<text x=\"" + (node.x - 10) + "\" y=\"" + (node.y + node.height / 2 + 14) + "\" text-anchor=\"end\" dominant-baseline=\"middle\" font-size=\"11\" fill=\"#64748b\">" + formatNumber(node.value) + "</text>";
  });

  // Draw target nodes
  targets.forEach(function(target) {
    const node = targetNodes[target];
    const nodeColor = tableColors[target] || "#0f172a";
    html += "<rect x=\"" + node.x + "\" y=\"" + node.y + "\" width=\"" + nodeWidth + "\" height=\"" + node.height + "\" fill=\"" + nodeColor + "\" rx=\"2\"/>";
    html += "<text x=\"" + (node.x + nodeWidth + 10) + "\" y=\"" + (node.y + node.height / 2) + "\" text-anchor=\"start\" dominant-baseline=\"middle\" font-size=\"13\" font-weight=\"500\" fill=\"#1e293b\">" + target + "</text>";
    html += "<text x=\"" + (node.x + nodeWidth + 10) + "\" y=\"" + (node.y + node.height / 2 + 14) + "\" text-anchor=\"start\" dominant-baseline=\"middle\" font-size=\"11\" fill=\"#64748b\">" + formatNumber(node.value) + "</text>";
  });

  // Add column headers
  html += "<text x=\"" + (leftX + nodeWidth / 2) + "\" y=\"30\" text-anchor=\"middle\" font-size=\"14\" font-weight=\"600\" fill=\"#0f172a\">Source</text>";
  html += "<text x=\"" + (rightX + nodeWidth / 2) + "\" y=\"30\" text-anchor=\"middle\" font-size=\"14\" font-weight=\"600\" fill=\"#0f172a\">Target</text>";

  html += "</svg>";
  html += "</div>";

  return html;
}

// ============================================================================
// CHART BUILDERS
// ============================================================================

function buildTypeConceptChartSimple(typeConceptsData) {
  if (!typeConceptsData || typeConceptsData.length === 0) {
    return "<p>No type concept data available</p>";
  }

  // Group by type_group and aggregate
  var grouped = {};
  typeConceptsData.forEach(function(tc) {
    var group = tc.type_group;
    if (!grouped[group]) {
      grouped[group] = { group: group, count: 0, concepts: [] };
    }
    grouped[group].count += tc.count;
    grouped[group].concepts.push(tc);
  });

  // Define canonical order
  var typeGroupOrder = REPORT_DATA.type_group_order || [
    "EHR", "Claims", "Disease registry", "Patient reported", "Other", "Unlabeled"
  ];

  // Ensure all groups from canonical order are present (with 0 counts if missing)
  typeGroupOrder.forEach(function(groupName) {
    if (!grouped[groupName]) {
      grouped[groupName] = { group: groupName, count: 0, concepts: [] };
    }
  });

  // Convert to array and sort by canonical order (not by count)
  var groupArray = [];
  for (var key in grouped) {
    if (grouped.hasOwnProperty(key)) {
      groupArray.push(grouped[key]);
    }
  }

  // Sort by canonical order
  var sortedGroups = groupArray.sort(function(a, b) {
    var indexA = typeGroupOrder.indexOf(a.group);
    var indexB = typeGroupOrder.indexOf(b.group);
    if (indexA === -1) indexA = 999; // Put unknown groups at end
    if (indexB === -1) indexB = 999;
    return indexA - indexB;
  });

  // Calculate total for percentages
  var total = 0;
  sortedGroups.forEach(function(g) { total += g.count; });

  var html = "";

  html += '<div style="display: flex; gap: 48px; margin: 20px 0; align-items: flex-start; justify-content: center;">';

  html += '<div style="flex-shrink: 0; padding-top: 40px;">';
  html += buildPieChart(sortedGroups, total);
  html += '</div>';

  html += '<div style="display: flex; flex-direction: column; gap: 12px; flex-shrink: 0;">';
  html += '<h5 style="margin: 0 0 8px 0; font-size: 0.85em; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Summary</h5>';
  sortedGroups.forEach(function(group) {
    var color = REPORT_DATA.type_colors[group.group] || "#7AA6DC";
    var percentage = ((group.count / total) * 100).toFixed(1);

    html += '<div style="display: flex; align-items: center; gap: 10px;">';
    html += '  <div style="width: 20px; height: 20px; background-color: ' + color + '; border: 1px solid #e5e7eb;"></div>';
    html += '  <div style="min-width: 200px;">';
    html += '    <div style="font-weight: 500; color: #0f172a;">' + group.group + '</div>';
    html += '    <div style="font-size: 0.9em; color: #64748b;">' + formatNumber(group.count) + ' (' + percentage + '%)</div>';
    html += '  </div>';
    html += '</div>';
  });
  html += '</div>';

  html += '</div>';

  return html;
}

function buildTypeConceptChart(typeConceptsData) {
  if (!typeConceptsData || typeConceptsData.length === 0) {
    return "<p>No type concept data available</p>";
  }

  // Group by type_group and aggregate
  var grouped = {};
  typeConceptsData.forEach(function(tc) {
    var group = tc.type_group;
    if (!grouped[group]) {
      grouped[group] = { group: group, count: 0, concepts: [] };
    }
    grouped[group].count += tc.count;
    grouped[group].concepts.push(tc);
  });

  // Define canonical order
  var typeGroupOrder = REPORT_DATA.type_group_order || [
    "EHR", "Claims", "Disease registry", "Patient reported", "Other", "Unlabeled"
  ];

  // Ensure all groups from canonical order are present (with 0 counts if missing)
  typeGroupOrder.forEach(function(groupName) {
    if (!grouped[groupName]) {
      grouped[groupName] = { group: groupName, count: 0, concepts: [] };
    }
  });

  // Convert to array and sort by canonical order (not by count)
  var groupArray = [];
  for (var key in grouped) {
    if (grouped.hasOwnProperty(key)) {
      groupArray.push(grouped[key]);
    }
  }

  // Sort by canonical order
  var sortedGroups = groupArray.sort(function(a, b) {
    var indexA = typeGroupOrder.indexOf(a.group);
    var indexB = typeGroupOrder.indexOf(b.group);
    if (indexA === -1) indexA = 999; // Put unknown groups at end
    if (indexB === -1) indexB = 999;
    return indexA - indexB;
  });

  // Calculate total for percentages
  var total = 0;
  sortedGroups.forEach(function(g) { total += g.count; });

  var html = "";

  html += '<div style="display: flex; gap: 48px; margin: 20px 0; align-items: flex-start; justify-content: center;">';

  html += '<div style="flex-shrink: 0; display: flex; align-items: center; padding-top: 40px;">';
  html += buildPieChart(sortedGroups, total);
  html += '</div>';

  html += '<div style="display: flex; flex-direction: column; gap: 12px; flex-shrink: 0;">';
  html += '<h5 style="margin: 0 0 8px 0; font-size: 0.85em; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Summary</h5>';
  sortedGroups.forEach(function(group) {
    var color = REPORT_DATA.type_colors[group.group] || "#7AA6DC";
    var percentage = ((group.count / total) * 100).toFixed(1);

    html += '<div style="display: flex; align-items: center; gap: 10px;">';
    html += '  <div style="width: 20px; height: 20px; background-color: ' + color + '; border: 1px solid #e5e7eb;"></div>';
    html += '  <div style="min-width: 200px;">';
    html += '    <div style="font-weight: 500; color: #0f172a;">' + group.group + '</div>';
    html += '    <div style="font-size: 0.9em; color: #64748b;">' + formatNumber(group.count) + ' (' + percentage + '%)</div>';
    html += '  </div>';
    html += '</div>';
  });
  html += '</div>';

  html += '<div style="flex: 1; border-left: 1px solid #e5e7eb; padding-left: 48px; min-width: 300px;">';
  html += '<h5 style="margin: 0 0 16px 0; font-size: 0.85em; color: #64748b; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;">Detailed Breakdown</h5>';
  sortedGroups.forEach(function(group) {
    // Only show groups with non-zero counts in detailed breakdown
    if (group.count > 0 && group.concepts.length > 0) {
      html += '<div style="margin-bottom: 20px;">';
      html += '  <div style="font-weight: 600; color: #0f172a; margin-bottom: 8px; font-size: 0.9em;">' + group.group + '</div>';
      html += '  <div style="margin-left: 16px; font-size: 0.85em; color: #475569;">';
      group.concepts.forEach(function(concept) {
        html += '<div style="padding: 3px 0;">• ' + concept.type_concept + ': ' + formatNumber(concept.count) + '</div>';
      });
      html += '  </div>';
      html += '</div>';
    }
  });
  html += '</div>';

  html += '</div>';

  return html;
}

function buildPieChart(sortedGroups, total) {
  var size = 300;
  var radius = 120;
  var cx = size / 2;
  var cy = size / 2;

  var html = `<svg width="` + size + `" height="` + size + `" style="display: block;">`;

  var currentAngle = -90;

  sortedGroups.forEach(function(group) {
    var color = REPORT_DATA.type_colors[group.group] || "#7AA6DC";
    var percentage = (group.count / total) * 100;
    var sliceAngle = (group.count / total) * 360;

    // Special case: if this is a full circle (or very close to it), draw a circle instead of arc
    if (sliceAngle >= 359.9) {
      html += `<circle cx="` + cx + `" cy="` + cy + `" r="` + radius + `" fill="` + color + `" stroke="#ffffff" stroke-width="2" style="cursor: pointer;">`;
      html += `  <title>` + group.group + `: ` + formatNumber(group.count) + ` (` + percentage.toFixed(1) + `%)</title>`;
      html += `</circle>`;
    } else {
      var startAngle = currentAngle * (Math.PI / 180);
      var endAngle = (currentAngle + sliceAngle) * (Math.PI / 180);

      var x1 = cx + radius * Math.cos(startAngle);
      var y1 = cy + radius * Math.sin(startAngle);
      var x2 = cx + radius * Math.cos(endAngle);
      var y2 = cy + radius * Math.sin(endAngle);

      var largeArcFlag = sliceAngle > 180 ? 1 : 0;

      var pathData = "M " + cx + " " + cy +
                     " L " + x1 + " " + y1 +
                     " A " + radius + " " + radius + " 0 " + largeArcFlag + " 1 " + x2 + " " + y2 +
                     " Z";

      html += `<path d="` + pathData + `" fill="` + color + `" stroke="#ffffff" stroke-width="2" style="cursor: pointer;">`;
      html += `  <title>` + group.group + `: ` + formatNumber(group.count) + ` (` + percentage.toFixed(1) + `%)</title>`;
      html += `</path>`;
    }

    currentAngle += sliceAngle;
  });

  var innerRadius = 50;
  html += `<circle cx="` + cx + `" cy="` + cy + `" r="` + innerRadius + `" fill="#ffffff" />`;

  html += `</svg>`;

  return html;
}

// ============================================================================
// UTILITY FUNCTIONS
// ============================================================================

function formatNumber(num) {
  if (num === null || num === undefined) return "0";
  return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
}

function getDQDClass(score) {
  if (score === null || score === undefined) return "";
  if (score >= 95) return "good";
  if (score >= 85) return "fair";
  return "poor";
}

function getPASSClass(score) {
  if (score === null || score === undefined || isNaN(score)) return "neutral";
  if (score >= 0.90) return "excellent";
  if (score >= 0.80) return "good";
  if (score >= 0.60) return "moderate";
  if (score >= 0.40) return "poor";
  return "verypoor";
}

function getPASSColor(score) {
  if (score === null || score === undefined || isNaN(score)) return "#94a3b8";
  if (score >= 0.90) return "#059669";  // excellent - emerald-600
  if (score >= 0.80) return "#10b981";  // good - emerald-500
  if (score >= 0.60) return "#f59e0b";  // moderate - amber-500
  if (score >= 0.40) return "#ef4444";  // poor - red-500
  return "#991b1b";  // verypoor - red-800
}

/**
 * Generate inline SVG visualization for PASS score with optional uncertainty range
 * @param {number} score - The PASS score (0-1)
 * @param {number|null} lowerBound - Lower bound of uncertainty (CI or score-SE)
 * @param {number|null} upperBound - Upper bound of uncertainty (CI or score+SE)
 * @param {number} width - SVG width in pixels (default: 140)
 * @param {number} height - SVG height in pixels (default: 32)
 * @returns {string} SVG HTML string
 */
function buildPASSScoreVisualization(score, lowerBound, upperBound, width, height) {
  width = width || 140;
  height = height || 32;

  if (score === null || score === undefined || isNaN(score)) {
    return '<span style="color: #94a3b8;">N/A</span>';
  }

  var padding = 12;
  var lineY = height / 2;
  var scaleStart = padding;
  var scaleEnd = width - padding;
  var scaleWidth = scaleEnd - scaleStart;

  // Helper to convert score (0-1) to x position
  function scoreToX(s) {
    return scaleStart + (s * scaleWidth);
  }

  var scoreX = scoreToX(score);
  var scoreColor = getPASSColor(score);
  var hasRange = (lowerBound !== null && lowerBound !== undefined &&
                  upperBound !== null && upperBound !== undefined &&
                  !isNaN(lowerBound) && !isNaN(upperBound));

  var svg = '<svg width="' + width + '" height="' + height + '" style="display: inline-block; vertical-align: middle;">';

  // Background line (0 to 1 scale)
  svg += '<line x1="' + scaleStart + '" y1="' + lineY + '" x2="' + scaleEnd + '" y2="' + lineY + '" ';
  svg += 'stroke="#cbd5e1" stroke-width="2" stroke-linecap="round"/>';

  // Uncertainty range (if provided)
  if (hasRange) {
    var lowerX = scoreToX(Math.max(0, Math.min(1, lowerBound)));
    var upperX = scoreToX(Math.max(0, Math.min(1, upperBound)));
    var rangeWidth = upperX - lowerX;

    // Range indicator - thicker line segment
    svg += '<line x1="' + lowerX + '" y1="' + lineY + '" x2="' + upperX + '" y2="' + lineY + '" ';
    svg += 'stroke="' + scoreColor + '" stroke-width="6" opacity="0.25" stroke-linecap="round"/>';

    // Whiskers at ends
    var whiskerHeight = 8;
    svg += '<line x1="' + lowerX + '" y1="' + (lineY - whiskerHeight/2) + '" ';
    svg += 'x2="' + lowerX + '" y2="' + (lineY + whiskerHeight/2) + '" ';
    svg += 'stroke="' + scoreColor + '" stroke-width="2" opacity="0.6"/>';

    svg += '<line x1="' + upperX + '" y1="' + (lineY - whiskerHeight/2) + '" ';
    svg += 'x2="' + upperX + '" y2="' + (lineY + whiskerHeight/2) + '" ';
    svg += 'stroke="' + scoreColor + '" stroke-width="2" opacity="0.6"/>';
  }

  // Score marker - filled circle
  var markerRadius = 5;
  svg += '<circle cx="' + scoreX + '" cy="' + lineY + '" r="' + markerRadius + '" ';
  svg += 'fill="' + scoreColor + '" stroke="#ffffff" stroke-width="2"/>';

  // Scale labels (0, 1)
  svg += '<text x="' + scaleStart + '" y="' + (height - 2) + '" ';
  svg += 'font-size="9" fill="#94a3b8" text-anchor="start">0</text>';

  svg += '<text x="' + scaleEnd + '" y="' + (height - 2) + '" ';
  svg += 'font-size="9" fill="#94a3b8" text-anchor="end">1</text>';

  svg += '</svg>';

  return svg;
}

// ============================================================================
// PASS COMPONENTS
// ============================================================================

function initializePASSOverallVisualization() {
  const vizContainer = document.getElementById("pass-overall-visualization");
  if (!vizContainer) return;

  // Check if PASS data exists
  if (!REPORT_DATA || REPORT_DATA.pass_overall_score === null || REPORT_DATA.pass_overall_score === undefined) {
    return;
  }

  const score = REPORT_DATA.pass_overall_score;
  const ciLower = REPORT_DATA.pass_ci_lower;
  const ciUpper = REPORT_DATA.pass_ci_upper;

  // Generate larger visualization for overall score (200px wide, no tooltip)
  const visualization = buildPASSScoreVisualization(score, ciLower, ciUpper, 200, 36);

  vizContainer.innerHTML = visualization;
}

function initializePASSComponents() {
  const container = document.getElementById("pass-components-container");
  if (!container) return;

  // Check if PASS data exists
  if (!REPORT_DATA || !REPORT_DATA.pass_components || REPORT_DATA.pass_components.length === 0) {
    container.innerHTML = '<tr><td colspan="3">No PASS component data available</td></tr>';
    return;
  }

  // Initialize overall score visualization (with 95% CI)
  initializePASSOverallVisualization();

  // Use components in the order provided by R (preserves temporal sub-metrics placement)
  const components = REPORT_DATA.pass_components;

  let html = "";

  // Build table rows
  components.forEach(function(component) {
    const score = component.score;
    const scoreFormatted = score.toFixed(2);

    // Use pre-calculated CI bounds from R (95% CI from metric overall files)
    const lowerBound = component.ci_lower || null;
    const upperBound = component.ci_upper || null;

    // Generate visualization (no tooltip)
    const visualization = buildPASSScoreVisualization(score, lowerBound, upperBound, 140, 32);

    // Build CI text if available
    let ciText = '';
    if (lowerBound !== null && upperBound !== null) {
      ciText = '<div style="font-size: 11px; color: #94a3b8; margin-top: 2px; font-weight: normal;">95% CI: ' + lowerBound.toFixed(2) + ' - ' + upperBound.toFixed(2) + '</div>';
    }

    // Check if this is a temporal sub-metric
    const isTemporalSub = component.metric.startsWith('temporal_');

    // Format metric name for display
    let metricDisplayName = component.metric;
    if (isTemporalSub) {
      // Extract sub-metric name (e.g., "temporal_range" -> "Range")
      const subMetricName = component.metric.replace('temporal_', '');
      metricDisplayName = subMetricName.charAt(0).toUpperCase() + subMetricName.slice(1);
    } else {
      // Format main metric names with proper capitalization
      if (component.metric === 'concept_diversity') {
        metricDisplayName = 'Concept Diversity';
      } else if (component.metric === 'source_diversity') {
        metricDisplayName = 'Source Diversity';
      } else {
        // Capitalize first letter for other metrics
        metricDisplayName = component.metric.charAt(0).toUpperCase() + component.metric.slice(1);
      }
    }

    // Apply indentation and special styling for temporal sub-metrics
    const rowClass = isTemporalSub ? 'pass-sub-metric-row' : '';
    const namePrefix = isTemporalSub ? '<span style="color: #94a3b8; margin-right: 6px;">↳</span>' : '';
    const nameStyle = isTemporalSub ? 'color: #64748b; font-size: 0.95em;' : '';

    html += '<tr class="' + rowClass + '">';
    html += '  <td class="pass-metric-name" style="' + nameStyle + '">' + namePrefix + metricDisplayName + '</td>';
    html += '  <td class="pass-score-cell" style="padding: 8px 12px;">';
    html += '    <div style="display: flex; align-items: center; gap: 12px;">';
    html += '      <div style="min-width: 40px;">';
    html += '        <div style="font-weight: 600;">' + scoreFormatted + '</div>';
    html += '        ' + ciText;
    html += '      </div>';
    html += '      ' + visualization;
    html += '    </div>';
    html += '  </td>';
    html += '  <td class="pass-description-cell">' + component.description + '</td>';
    html += '</tr>';
  });

  container.innerHTML = html;
}

// ============================================================================
// CSV EXPORT
// ============================================================================

function exportTableToCSV() {
  // Get the current group name for the filename
  const selector = document.getElementById("table-group-selector");
  const groupName = selector ? selector.value : "All Tables";

  // Find the visible table in the delivery report section
  const visibleGroup = document.querySelector(".table-group-content:not([style*=\"display: none\"])");
  if (!visibleGroup) {
    alert("No table visible to export");
    return;
  }

  const table = visibleGroup.querySelector("table");
  if (!table) {
    alert("No table found to export");
    return;
  }

  // Extract table data
  const rows = [];

  // Get headers
  const headers = [];
  const headerCells = table.querySelectorAll("thead th");
  headerCells.forEach(function(th) {
    headers.push(th.textContent.trim());
  });
  rows.push(headers);

  // Get data rows
  const dataRows = table.querySelectorAll("tbody tr");
  dataRows.forEach(function(tr) {
    const rowData = [];
    const cells = tr.querySelectorAll("td");
    cells.forEach(function(td) {
      // Clean up the cell text (remove extra whitespace, get text only)
      let text = td.textContent.trim();
      // Escape quotes and wrap in quotes if contains comma
      if (text.includes(",") || text.includes("\"") || text.includes("\n")) {
        text = "\"" + text.replace(/"/g, "\"\"\"") + "\"";
      }
      rowData.push(text);
    });
    rows.push(rowData);
  });

  // Create CSV content
  const csvContent = rows.map(function(row) {
    return row.join(",");
  }).join("\n");

  // Create blob and download
  const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
  const link = document.createElement("a");
  const url = URL.createObjectURL(blob);

  // Create filename with current date
  const date = new Date().toISOString().split("T")[0];
  const filename = "delivery_report_" + groupName.toLowerCase().replace(/ /g, "_") + "_" + date + ".csv";

  link.setAttribute("href", url);
  link.setAttribute("download", filename);
  link.style.visibility = "hidden";
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// ============================================================================
// SIDEBAR NAVIGATION
// ============================================================================

function scrollToSection(event, sectionId) {
  event.preventDefault();

  var section = document.getElementById(sectionId);
  if (section) {
    section.scrollIntoView({ behavior: "smooth", block: "start" });

    // Update active nav item
    var navItems = document.querySelectorAll(".sidebar-nav-item");
    navItems.forEach(function(item) {
      item.classList.remove("active");
    });
    event.target.classList.add("active");
  }
}

// Track scroll position and update active nav item
function updateActiveNavOnScroll() {
  var sections = document.querySelectorAll(".section");
  var scrollPos = window.scrollY + 200;

  sections.forEach(function(section) {
    var sectionTop = section.offsetTop;
    var sectionHeight = section.offsetHeight;
    var sectionId = section.getAttribute("id");

    if (scrollPos >= sectionTop && scrollPos < sectionTop + sectionHeight) {
      var navItems = document.querySelectorAll(".sidebar-nav-item");
      navItems.forEach(function(item) {
        item.classList.remove("active");
        if (item.getAttribute("href") === "#" + sectionId) {
          item.classList.add("active");
        }
      });
    }
  });
}

// ============================================================================
// INITIALIZATION
// ============================================================================

document.addEventListener("DOMContentLoaded", function() {
  console.log("OMOP Delivery Report initialized");
  console.log("Report data loaded:", REPORT_DATA ? "Yes" : "No");

  // Initialize dataset-wide type concepts
  initializeDatasetTypeConcepts();

  // Set initial table group
  switchTableGroup("Clinical Data");

  // Initialize vocabulary harmonization section
  initializeVocabHarmonization();

  // Initialize data timeline section
  initializeTimeSeries();

  // Initialize PASS components section
  initializePASSComponents();

  // Set up scroll tracking for sidebar navigation
  window.addEventListener("scroll", updateActiveNavOnScroll);
  updateActiveNavOnScroll();

  // Event delegation for data-action attributes
  document.addEventListener("click", function(event) {
    const target = event.target.closest("[data-action]");
    if (!target) return;

    const action = target.dataset.action;

    switch (action) {
      case "scroll-to-section":
        scrollToSection(event, target.dataset.section);
        break;
      case "export-table":
        exportTableToCSV();
        break;
      case "show-drilldown":
        showTableDrilldown(target.dataset.table);
        break;
      case "hide-drilldown":
        hideTableDrilldown();
        break;
      case "sort-table":
        sortDeliveryTable(target.dataset.group, parseInt(target.dataset.column), target.dataset.sortType);
        break;
      case "switch-time-series-view":
        switchTimeSeriesView(target.dataset.view);
        break;
      case "apply-year-range":
        applyCustomYearRange();
        break;
      case "switch-drilldown-time-series-view":
        switchTableDrilldownTimeSeriesView(target.dataset.view);
        break;
      case "apply-drilldown-year-range":
        applyTableDrilldownCustomYearRange();
        break;
      case "toggle-table-visibility":
        toggleTableVisibility(target.dataset.table);
        break;
    }
  });

  // Event delegation for change events
  document.addEventListener("change", function(event) {
    const target = event.target.closest("[data-action]");
    if (!target) return;

    const action = target.dataset.action;

    switch (action) {
      case "switch-table-group":
        switchTableGroup(target.value);
        break;
    }
  });

  // Log available groups
  if (REPORT_DATA && REPORT_DATA.groups) {
    console.log("Available table groups:", Object.keys(REPORT_DATA.groups));
  }
});

function initializeDatasetTypeConcepts() {
  console.log("==== initializeDatasetTypeConcepts ====");

  var container = document.getElementById("dataset-type-concepts");
  if (!container) {
    console.warn("Dataset type concepts container not found");
    return;
  }

  // Use the overall type concepts directly from REPORT_DATA
  var allTypeConcepts = REPORT_DATA.overall_type_concepts || [];

  console.log("Total type concepts found:", allTypeConcepts.length);

  if (allTypeConcepts.length === 0) {
    container.innerHTML = "<p>No type concept data available</p>";
    return;
  }

  var html = buildTypeConceptChart(allTypeConcepts);
  container.innerHTML = html;
  console.log("Dataset type concepts initialized successfully");
}

// ============================================================================
// BROWSER HISTORY MANAGEMENT
// ============================================================================

// Handle browser back button
window.addEventListener("popstate", function(event) {
  if (event.state && event.state.view === "drilldown") {
    // Going forward to a drilldown view
    showTableDrilldown(event.state.table);
  } else {
    // Going back to main report
    hideTableDrilldown();
  }
});

// Initialize history state on page load
window.addEventListener("load", function() {
  // Set initial state for the main report view
  history.replaceState({ view: "main" }, "", window.location.pathname);
});

// ============================================================================
// DATA TIMELINE VISUALIZATION
// ============================================================================

// Global state for data timeline (time series)
let currentTimeSeriesView = "recent";
let timeSeriesData = [];
let timeSeriesConfig = {};
let visibleTables = new Set(); // Track which tables are visible
let allUniqueTables = []; // Store ALL unique tables once at initialization
let customStartYear = 1970;
let customEndYear = 2025;

// Global state for table drilldown timeline
let currentTableDrilldownView = "recent";
let currentDrilldownTable = null;
let drilldownCustomStartYear = 1970;
let drilldownCustomEndYear = 2025;

// Use table colors from configuration (set when REPORT_DATA loads)
const TIME_SERIES_COLORS = REPORT_DATA.table_colors || {};

function switchTimeSeriesView(view) {
  console.log("Switching data timeline view to:", view);
  currentTimeSeriesView = view;

  // Update button states
  document.getElementById("btn-recent-view").classList.toggle("active", view === "recent");
  document.getElementById("btn-custom-view").classList.toggle("active", view === "custom");

  // Show/hide custom year controls
  const customControls = document.getElementById("custom-year-controls");
  if (customControls) {
    customControls.style.display = view === "custom" ? "block" : "none";
  }

  // Redraw chart
  drawTimeSeriesChart();
}

function toggleTableVisibility(tableName) {
  console.log("Toggling visibility for:", tableName);

  // Don't allow hiding all tables
  if (visibleTables.size === 1 && visibleTables.has(tableName)) {
    console.log("Cannot hide the last visible table");
    return;
  }

  // Toggle visibility
  if (visibleTables.has(tableName)) {
    visibleTables.delete(tableName);
  } else {
    visibleTables.add(tableName);
  }

  console.log("Visible tables:", Array.from(visibleTables));

  // Redraw chart (this will also update the legend)
  drawTimeSeriesChart();
}

function applyCustomYearRange() {
  console.log("Applying custom year range");

  // Get input values
  const startInput = document.getElementById("custom-start-year");
  const endInput = document.getElementById("custom-end-year");

  if (!startInput || !endInput) {
    console.error("Custom year inputs not found");
    return;
  }

  const startYear = parseInt(startInput.value);
  const endYear = parseInt(endInput.value);

  // Validate
  if (isNaN(startYear) || isNaN(endYear)) {
    alert("Please enter valid years");
    return;
  }

  if (startYear >= endYear) {
    alert("Start year must be less than end year");
    return;
  }

  if (startYear < 1900 || endYear > 2100) {
    alert("Please enter years between 1900 and 2100");
    return;
  }

  // Update state
  customStartYear = startYear;
  customEndYear = endYear;

  console.log("Custom range set to:", startYear, "-", endYear);

  // Redraw chart
  drawTimeSeriesChart();
}

function initializeTimeSeries() {
  console.log("Initializing data timeline...");

  // Load data from embedded JSON
  const dataElement = document.getElementById("time-series-data");
  const configElement = document.getElementById("time-series-config");

  if (!dataElement || !configElement) {
    console.log("Data timeline data not found");
    return;
  }

  try {
    timeSeriesData = JSON.parse(dataElement.textContent);
    timeSeriesConfig = JSON.parse(configElement.textContent);
    console.log("Loaded data timeline data:", timeSeriesData.length, "rows");
    console.log("Config:", timeSeriesConfig);

    // Initialize custom year range from config
    customStartYear = timeSeriesConfig.historicalStartYear || 1970;
    customEndYear = timeSeriesConfig.deliveryYear || 2025;

    // Store ALL unique tables from the dataset (THIS IS THE MASTER LIST!)
    // Sort using canonical table order from R configuration
    allUniqueTables = sortTablesByOrder([...new Set(timeSeriesData.map(d => d.table_name))]);
    console.log("All unique tables:", allUniqueTables);

    // Initialize visible tables (all tables visible by default)
    visibleTables = new Set(allUniqueTables);
    console.log("Initialized visible tables:", Array.from(visibleTables));

    // Draw initial chart
    drawTimeSeriesChart();
  } catch (e) {
    console.error("Error parsing data timeline data:", e);
  }
}

function drawTimeSeriesChart() {
  console.log("Drawing data timeline chart for view:", currentTimeSeriesView);

  const container = document.getElementById("time-series-chart-container");
  if (!container) return;

  // ALWAYS update legend first using the MASTER TABLE LIST
  // This ensures ALL tables are always shown in the legend
  updateTimeSeriesLegend(allUniqueTables);

  if (timeSeriesData.length === 0) {
    container.innerHTML = "<p>No time series data available</p>";
    return;
  }

  // Determine year range based on view
  let startYear, endYear;
  if (currentTimeSeriesView === "recent") {
    startYear = timeSeriesConfig.recentStartYear;
    endYear = timeSeriesConfig.recentEndYear;
  } else if (currentTimeSeriesView === "custom") {
    startYear = customStartYear;
    endYear = customEndYear;
  } else {
    startYear = timeSeriesConfig.historicalStartYear;
    endYear = timeSeriesConfig.historicalEndYear;
  }

  // Filter data by year range, visible tables, and group by table
  const tableData = {};
  timeSeriesData.forEach(function(row) {
    // Only include visible tables
    if (!visibleTables.has(row.table_name)) {
      return;
    }

    if (row.year >= startYear && row.year <= endYear) {
      if (!tableData[row.table_name]) {
        tableData[row.table_name] = [];
      }
      tableData[row.table_name].push({ year: row.year, count: row.count });
    }
  });

  // Sort each table's data by year
  Object.keys(tableData).forEach(function(table) {
    tableData[table].sort(function(a, b) { return a.year - b.year; });
  });

  // Sort tables using canonical order from R configuration
  const tables = sortTablesByOrder(Object.keys(tableData));
  console.log("Tables with data:", tables);

  if (tables.length === 0) {
    container.innerHTML = "<p>No data available for the selected time range</p>";
    return;
  }

  // Calculate dimensions
  const containerWidth = container.clientWidth;
  const containerHeight = 500;
  const margin = { top: 20, right: 120, bottom: 60, left: 80 };
  const chartWidth = containerWidth - margin.left - margin.right;
  const chartHeight = containerHeight - margin.top - margin.bottom;

  // Calculate scales
  const allCounts = [];
  Object.keys(tableData).forEach(function(table) {
    tableData[table].forEach(function(d) {
      allCounts.push(d.count);
    });
  });

  const maxCount = Math.max.apply(null, allCounts);
  const minCount = 0;

  // Create x-scale (year)
  const xScale = function(year) {
    return margin.left + (year - startYear) / (endYear - startYear) * chartWidth;
  };

  // Create y-scale (count)
  const yScale = function(count) {
    return margin.top + chartHeight - (count - minCount) / (maxCount - minCount) * chartHeight;
  };

  // Build SVG
  let html = '<svg width="' + containerWidth + '" height="' + containerHeight + '" style="background: white; border-radius: 8px; border: 2px solid #e2e8f0;">';

  // Draw grid lines (horizontal)
  const numGridLines = 5;
  for (let i = 0; i <= numGridLines; i++) {
    const y = margin.top + (chartHeight / numGridLines) * i;
    html += '<line x1="' + margin.left + '" y1="' + y + '" x2="' + (margin.left + chartWidth) + '" y2="' + y + '" stroke="#e2e8f0" stroke-width="1"/>';

    // Y-axis labels
    const labelCount = maxCount - (maxCount / numGridLines) * i;
    html += '<text x="' + (margin.left - 10) + '" y="' + y + '" text-anchor="end" dominant-baseline="middle" font-size="12" fill="#64748b">' + formatNumber(Math.round(labelCount)) + '</text>';
  }

  // Draw x-axis ticks and labels
  const yearRange = endYear - startYear;
  const tickInterval = yearRange > 30 ? 5 : (yearRange > 15 ? 2 : 1);

  for (let year = startYear; year <= endYear; year += tickInterval) {
    const x = xScale(year);
    html += '<line x1="' + x + '" y1="' + (margin.top + chartHeight) + '" x2="' + x + '" y2="' + (margin.top + chartHeight + 6) + '" stroke="#64748b" stroke-width="1"/>';
    html += '<text x="' + x + '" y="' + (margin.top + chartHeight + 20) + '" text-anchor="middle" font-size="12" fill="#64748b">' + year + '</text>';
  }

  // Draw axes
  html += '<line x1="' + margin.left + '" y1="' + margin.top + '" x2="' + margin.left + '" y2="' + (margin.top + chartHeight) + '" stroke="#1e293b" stroke-width="2"/>';
  html += '<line x1="' + margin.left + '" y1="' + (margin.top + chartHeight) + '" x2="' + (margin.left + chartWidth) + '" y2="' + (margin.top + chartHeight) + '" stroke="#1e293b" stroke-width="2"/>';

  // Axis labels
  html += '<text x="' + (margin.left + chartWidth / 2) + '" y="' + (containerHeight - 10) + '" text-anchor="middle" font-size="14" font-weight="600" fill="#0f172a">Year</text>';
  html += '<text x="' + (margin.left - 60) + '" y="' + (margin.top + chartHeight / 2) + '" text-anchor="middle" font-size="14" font-weight="600" fill="#0f172a" transform="rotate(-90 ' + (margin.left - 60) + ' ' + (margin.top + chartHeight / 2) + ')">Row Count</text>';

  // Draw lines for each table
  tables.forEach(function(table) {
    const data = tableData[table];
    const color = TIME_SERIES_COLORS[table] || "#64748b";

    if (data.length === 0) return;

    // Build path
    let pathD = "M";
    data.forEach(function(d, i) {
      const x = xScale(d.year);
      const y = yScale(d.count);
      if (i === 0) {
        pathD += x + "," + y;
      } else {
        pathD += " L" + x + "," + y;
      }
    });

    // Draw line
    html += '<path d="' + pathD + '" stroke="' + color + '" stroke-width="2.5" fill="none" style="cursor: pointer;">';
    html += '<title>' + table + '</title>';
    html += '</path>';

    // Draw points
    data.forEach(function(d) {
      const x = xScale(d.year);
      const y = yScale(d.count);
      const tooltipText = table + ' (' + d.year + '): ' + formatNumber(d.count);
      html += '<circle cx="' + x + '" cy="' + y + '" r="4" fill="' + color + '" stroke="white" stroke-width="1.5" style="cursor: pointer;" class="time-series-point" data-tooltip="' + tooltipText + '" onmouseenter="showTimeSeriesTooltip(event, \'' + tooltipText.replace(/'/g, "\\'") + '\')" onmouseleave="hideTimeSeriesTooltip()">';
      html += '<title>' + table + ' (' + d.year + '): ' + formatNumber(d.count) + '</title>';
      html += '</circle>';
    });
  });

  html += '</svg>';

  container.innerHTML = html;
}

function updateTimeSeriesLegend(allTables) {
  const legendContainer = document.getElementById("time-series-legend");
  if (!legendContainer) return;

  let html = "";
  allTables.forEach(function(table) {
    const color = TIME_SERIES_COLORS[table] || "#64748b";
    const isVisible = visibleTables.has(table);
    const inactiveClass = isVisible ? "" : " inactive";

    html += '<div class="legend-item' + inactiveClass + '" data-action="toggle-table-visibility" data-table="' + table + '">';
    html += '  <div style="display: flex; align-items: center; gap: 8px;">';
    html += '    <div class="legend-line" style="width: 30px; height: 3px; background-color: ' + color + ';"></div>';
    html += '    <span class="legend-label" style="font-size: 0.9em; color: #475569; font-weight: 500;">' + table + '</span>';
    html += '  </div>';
    html += '</div>';
  });

  legendContainer.innerHTML = html;
}

// ============================================================================
// TABLE DRILLDOWN TIMELINE
// ============================================================================

function initializeTableDrilldownTimeSeries(tableName) {
  console.log("Initializing table drilldown timeline for:", tableName);
  currentDrilldownTable = tableName;

  // Set default view to recent
  currentTableDrilldownView = "recent";

  // Set default custom year range from config
  if (timeSeriesConfig.historicalStartYear && timeSeriesConfig.deliveryYear) {
    drilldownCustomStartYear = timeSeriesConfig.historicalStartYear;
    drilldownCustomEndYear = timeSeriesConfig.deliveryYear;
  }

  // Draw the chart
  drawTableDrilldownTimeSeries();
}

function switchTableDrilldownTimeSeriesView(view) {
  console.log("Switching table drilldown view to:", view);
  currentTableDrilldownView = view;

  // Update button states
  const recentBtn = document.getElementById("drilldown-time-series-recent");
  const customBtn = document.getElementById("drilldown-time-series-custom");
  const customControls = document.getElementById("drilldown-time-series-custom-controls");

  if (recentBtn && customBtn && customControls) {
    if (view === "recent") {
      recentBtn.classList.add("active");
      customBtn.classList.remove("active");
      customControls.style.display = "none";
    } else if (view === "custom") {
      recentBtn.classList.remove("active");
      customBtn.classList.add("active");
      customControls.style.display = "flex";

      // Populate inputs with current values
      document.getElementById("drilldown-time-series-start-year").value = drilldownCustomStartYear;
      document.getElementById("drilldown-time-series-end-year").value = drilldownCustomEndYear;
    }
  }

  drawTableDrilldownTimeSeries();
}

function applyTableDrilldownCustomYearRange() {
  const startInput = document.getElementById("drilldown-time-series-start-year");
  const endInput = document.getElementById("drilldown-time-series-end-year");

  const startYear = parseInt(startInput.value);
  const endYear = parseInt(endInput.value);

  if (isNaN(startYear) || isNaN(endYear)) {
    alert("Please enter valid years");
    return;
  }

  if (startYear >= endYear) {
    alert("Start year must be before end year");
    return;
  }

  drilldownCustomStartYear = startYear;
  drilldownCustomEndYear = endYear;

  drawTableDrilldownTimeSeries();
}

function drawTableDrilldownTimeSeries() {
  console.log("Drawing table drilldown timeline for:", currentDrilldownTable);

  const container = document.getElementById("table-drilldown-time-series-chart-container");
  if (!container) {
    console.log("Container not found");
    return;
  }

  if (!currentDrilldownTable || timeSeriesData.length === 0) {
    container.innerHTML = "<p>No time series data available</p>";
    return;
  }

  // Determine year range based on view
  let startYear, endYear;
  if (currentTableDrilldownView === "recent") {
    startYear = timeSeriesConfig.recentStartYear;
    endYear = timeSeriesConfig.recentEndYear;
  } else if (currentTableDrilldownView === "custom") {
    startYear = drilldownCustomStartYear;
    endYear = drilldownCustomEndYear;
  } else {
    startYear = timeSeriesConfig.historicalStartYear;
    endYear = timeSeriesConfig.historicalEndYear;
  }

  // Filter data for this table and year range
  const tableData = timeSeriesData.filter(function(row) {
    return row.table_name === currentDrilldownTable &&
           row.year >= startYear &&
           row.year <= endYear;
  });

  if (tableData.length === 0) {
    container.innerHTML = "<p>No data available for the selected time range</p>";
    return;
  }

  // Sort by year
  tableData.sort(function(a, b) { return a.year - b.year; });

  // Calculate dimensions
  const containerWidth = container.clientWidth;
  const containerHeight = 450;
  const margin = { top: 20, right: 40, bottom: 60, left: 80 };
  const chartWidth = containerWidth - margin.left - margin.right;
  const chartHeight = containerHeight - margin.top - margin.bottom;

  // Calculate scales
  const maxCount = Math.max.apply(null, tableData.map(function(d) { return d.count; }));
  const minCount = 0;

  // Create x-scale (year)
  const xScale = function(year) {
    return margin.left + (year - startYear) / (endYear - startYear) * chartWidth;
  };

  // Create y-scale (count)
  const yScale = function(count) {
    return margin.top + chartHeight - ((count - minCount) / (maxCount - minCount)) * chartHeight;
  };

  // Get color for this table
  const color = TIME_SERIES_COLORS[currentDrilldownTable] || "#3b82f6";

  // Build SVG
  let html = '<svg width="' + containerWidth + '" height="' + containerHeight + '" style="background: white; border-radius: 8px;">';

  // Draw grid lines and Y-axis labels
  const numYTicks = 5;
  for (let i = 0; i <= numYTicks; i++) {
    const count = minCount + (maxCount - minCount) * (i / numYTicks);
    const y = yScale(count);

    // Grid line
    html += '<line x1="' + margin.left + '" y1="' + y + '" x2="' + (margin.left + chartWidth) + '" y2="' + y + '" stroke="#e5e7eb" stroke-width="1" />';

    // Y-axis label
    html += '<text x="' + (margin.left - 10) + '" y="' + (y + 4) + '" text-anchor="end" font-size="11" fill="#64748b">' + formatNumber(Math.round(count)) + '</text>';
  }

  // Draw X-axis (years)
  const yearRange = endYear - startYear;
  const yearStep = yearRange <= 15 ? 1 : Math.ceil(yearRange / 15);

  for (let year = startYear; year <= endYear; year += yearStep) {
    const x = xScale(year);
    const y = margin.top + chartHeight;

    // Tick mark
    html += '<line x1="' + x + '" y1="' + y + '" x2="' + x + '" y2="' + (y + 6) + '" stroke="#94a3b8" stroke-width="1" />';

    // Year label
    html += '<text x="' + x + '" y="' + (y + 20) + '" text-anchor="middle" font-size="11" fill="#64748b">' + year + '</text>';
  }

  // Draw line
  let pathData = "M";
  tableData.forEach(function(d, i) {
    const x = xScale(d.year);
    const y = yScale(d.count);
    if (i === 0) {
      pathData += x + "," + y;
    } else {
      pathData += " L" + x + "," + y;
    }
  });

  html += '<path d="' + pathData + '" fill="none" stroke="' + color + '" stroke-width="3" />';

  // Draw points
  tableData.forEach(function(d) {
    const x = xScale(d.year);
    const y = yScale(d.count);
    const tooltipText = currentDrilldownTable + ' (' + d.year + '): ' + formatNumber(d.count);
    html += '<circle cx="' + x + '" cy="' + y + '" r="5" fill="' + color + '" stroke="white" stroke-width="2" style="cursor: pointer;" class="time-series-point" onmouseenter="showTimeSeriesTooltip(event, \'' + tooltipText.replace(/'/g, "\\'") + '\')" onmouseleave="hideTimeSeriesTooltip()">';
    html += '<title>' + currentDrilldownTable + ' (' + d.year + '): ' + formatNumber(d.count) + '</title>';
    html += '</circle>';
  });

  html += '</svg>';

  container.innerHTML = html;
}

// ============================================================================
// CUSTOM TOOLTIP FOR TIME SERIES
// ============================================================================

function showTimeSeriesTooltip(event, text) {
  // Remove any existing tooltip
  hideTimeSeriesTooltip();

  // Create tooltip element
  const tooltip = document.createElement('div');
  tooltip.id = 'time-series-custom-tooltip';
  tooltip.style.position = 'absolute';
  tooltip.style.background = 'rgba(15, 23, 42, 0.95)';
  tooltip.style.color = 'white';
  tooltip.style.padding = '8px 12px';
  tooltip.style.borderRadius = '6px';
  tooltip.style.fontSize = '13px';
  tooltip.style.fontWeight = '500';
  tooltip.style.pointerEvents = 'none';
  tooltip.style.zIndex = '10000';
  tooltip.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.1)';
  tooltip.style.whiteSpace = 'nowrap';
  tooltip.textContent = text;

  document.body.appendChild(tooltip);

  // Position tooltip near cursor
  const x = event.pageX;
  const y = event.pageY;
  tooltip.style.left = (x + 10) + 'px';
  tooltip.style.top = (y - 35) + 'px';
}

function hideTimeSeriesTooltip() {
  const tooltip = document.getElementById('time-series-custom-tooltip');
  if (tooltip) {
    tooltip.remove();
  }
}

// ============================================================================
// END OF JAVASCRIPT
// ============================================================================
  
    </script>
</body>
</html>
